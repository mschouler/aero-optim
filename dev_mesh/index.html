<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://mschouler.github.io/aero-optim/dev_mesh/" />
      <link rel="shortcut icon" href="../Figures/icon.png" />
    <title>Mesh Module - AERO-Optim</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Mesh Module";
        var mkdocs_page_input_path = "dev_mesh.md";
        var mkdocs_page_url = "/aero-optim/dev_mesh/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="..">
          <img src="../Figures/logo.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Getting Started</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">User Guide</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ffd/">FFD Module</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../mesh/">Mesh Module</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../simulator/">Simulator Module</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../optimizer/">Evolution and Optimizer Modules</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../mfsm/">Multi-Fidelity Surrogate Module</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Developer Guide</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../dev_ffd/">FFD Module</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Mesh Module</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#mesh.mesh.Mesh">Mesh</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#mesh.mesh.Mesh.__init__">__init__</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mesh.mesh.Mesh.add_corners">add_corners</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mesh.mesh.Mesh.build_2dmesh">build_2dmesh</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mesh.mesh.Mesh.build_3dmesh">build_3dmesh</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mesh.mesh.Mesh.build_mesh">build_mesh</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mesh.mesh.Mesh.get_meshfile">get_meshfile</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mesh.mesh.Mesh.get_nlayer">get_nlayer</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mesh.mesh.Mesh.merge_refs">merge_refs</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mesh.mesh.Mesh.process_config">process_config</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mesh.mesh.Mesh.reformat_2d">reformat_2d</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mesh.mesh.Mesh.write_mesh">write_mesh</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#mesh.naca_base_mesh.NACABaseMesh">NACABaseMesh</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#mesh.naca_base_mesh.NACABaseMesh.__init__">__init__</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mesh.naca_base_mesh.NACABaseMesh.build_2dmesh">build_2dmesh</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mesh.naca_base_mesh.NACABaseMesh.build_bl">build_bl</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mesh.naca_base_mesh.NACABaseMesh.split_naca">split_naca</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#mesh.naca_block_mesh.NACABlockMesh">NACABlockMesh</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#mesh.naca_block_mesh.NACABlockMesh.__init__">__init__</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mesh.naca_block_mesh.NACABlockMesh.build_2dmesh">build_2dmesh</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#mesh.cascade_mesh.CascadeMesh">CascadeMesh</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#mesh.cascade_mesh.CascadeMesh.__init__">__init__</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mesh.cascade_mesh.CascadeMesh.build_2dmesh">build_2dmesh</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mesh.cascade_mesh.CascadeMesh.build_3dmesh">build_3dmesh</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mesh.cascade_mesh.CascadeMesh.build_bl">build_bl</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mesh.cascade_mesh.CascadeMesh.build_cylinder_field">build_cylinder_field</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mesh.cascade_mesh.CascadeMesh.build_minaniso_field">build_minaniso_field</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mesh.cascade_mesh.CascadeMesh.reorder_blade">reorder_blade</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dev_simulator/">Simulator Module</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dev_optimizer/">Evolution and Optimizer Modules</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dev_mfsm/">Multi-Fidelity Surrogate Module</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../coverage/">Coverage Report</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Optimization Examples</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../example_custom/">Customized Optimization</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../example_smo/">Surrogate based Optimization</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../example_mf_smo/">Multi-Fidelity Surrogate based Optimization</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">AERO-Optim</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Developer Guide</li>
      <li class="breadcrumb-item active">Mesh Module</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/mschouler/aero-optim/edit/master/docs/dev_mesh.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h2 id="mesh-source-code">Mesh Source Code</h2>
<hr style="border:1px solid grey">



<div class="doc doc-object doc-class">



<h3 id="mesh.mesh.Mesh" class="doc doc-heading">
            <code>mesh.mesh.Mesh</code>


</h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>


        <p>This class implements an abstract meshing class.</p>







              <details class="quote">
                <summary>Source code in <code>aero_optim/mesh/mesh.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Mesh</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class implements an abstract meshing class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">datfile</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instantiates the abstract Mesh object.</span>

<span class="sd">        **Input**</span>

<span class="sd">        - config (dict): the config file dictionary.</span>
<span class="sd">        - dat_file (str): path to input_geometry.dat.</span>

<span class="sd">        **Inner**</span>

<span class="sd">        - outdir (str): path/to/outputdirectory</span>
<span class="sd">        - outfile (str): the core name of all outputed files e.g. outfile.log, outfile.mesh, etc.</span>
<span class="sd">        - header (int): the number of header lines in dat_file.</span>
<span class="sd">        - geom_scale (float): geometry scaling factor.</span>
<span class="sd">        - mesh_format (str): the mesh format (mesh or cgns).</span>
<span class="sd">        - bl (bool): whether to mesh the boundary layer (True) or not (False).</span>
<span class="sd">        - bl_thickness (float): the BL meshing cumulated thickness.</span>
<span class="sd">        - bl_ratio (float): the BL meshing growth ratio.</span>
<span class="sd">        - bl_size (float): the BL first element size.</span>
<span class="sd">        - bl_fan_elements (int): the number of BL fan elements.</span>
<span class="sd">        - mesh_order (int): the order of the mesh.</span>
<span class="sd">        - structured (bool): whether to recombine triangles (True) or not (False).</span>
<span class="sd">        - extrusion_layers (int): the number of extrusion layers when generating a 3D mesh.</span>
<span class="sd">        - extrusion_size (float): the total size of the extruded layers.</span>
<span class="sd">        - GUI (bool): whether to launch gmsh GUI (True) or not (False).</span>
<span class="sd">        - nview (int): the number of sub-windows in gmsh GUI.</span>
<span class="sd">        - quality (bool): whether to display quality metrics in gmsh GUI (True) or not (False).</span>
<span class="sd">        - pts (list[list[float]]): the geometry coordinates.</span>
<span class="sd">        - surf_tag (list[int]): flow-field elements tags used to recombine the mesh if structured.</span>
<span class="sd">        - non_corner_tags (list[int]): non-corner physical entity tags used to define &#39;Corners&#39;.</span>
<span class="sd">        - lower_tag (list[int]): lower periodic tags to be identified as one.</span>
<span class="sd">        - lower_tag (list[int]): upper periodic tags to be identified as one.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_config</span><span class="p">()</span>
        <span class="c1"># study params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dat_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">datfile</span> <span class="k">if</span> <span class="n">datfile</span> <span class="k">else</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;study&quot;</span><span class="p">][</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outdir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;study&quot;</span><span class="p">][</span><span class="s2">&quot;outdir&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outfile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;study&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;outfile&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dat_file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
        <span class="c1"># mesh params (geom, format &amp; boundary layer)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;header&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geom_scale</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;scale&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mesh_format&quot;</span><span class="p">,</span> <span class="s2">&quot;mesh&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bl</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bl_thickness</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;bl_thickness&quot;</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bl_ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;bl_ratio&quot;</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bl_size</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;bl_size&quot;</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bl_fan_elements</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;bl_fan_elements&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_order</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;order&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="c1"># mesh params (3d extrusion)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">structured</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;structured&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extrusion_layers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extrusion_layers&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extrusion_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extrusion_size&quot;</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
        <span class="c1"># gui options</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GUI</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;view&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;GUI&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nview</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;view&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nview&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quality</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;view&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;quality&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="c1"># geometry coordinates loading</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="n">from_dat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dat_file</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom_scale</span><span class="p">)</span>
        <span class="c1"># flow-field and non-corner tags (for recombination and corners definition)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surf_tag</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">non_corner_tags</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_nlayer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Returns** the number of layers required to reach bl_thickness given the growth bl_ratio</span>
<span class="sd">        and the first element size bl_size.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span>
            <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl_thickness</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl_ratio</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl_size</span><span class="p">)</span>
            <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bl_ratio</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Defines** the gmsh routine.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s1">&#39;General.Terminal&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">build_2dmesh</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build_3dmesh</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extrusion_layers</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">structured</span><span class="p">:</span>
            <span class="p">[</span><span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setRecombine</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">id</span><span class="p">))</span> <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">surf_tag</span><span class="p">]</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extrusion_layers</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_order</span><span class="p">:</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_order</span><span class="p">)</span>

        <span class="c1"># visualization</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">quality</span><span class="p">:</span>
            <span class="n">plot_quality</span><span class="p">()</span>
        <span class="n">elt_type</span> <span class="o">=</span> <span class="s2">&quot;Mesh.Triangles&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">structured</span> <span class="k">else</span> <span class="s2">&quot;Mesh.Quadrangles&quot;</span>
        <span class="n">color</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s2">&quot;General.BackgroundGradient&quot;</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
            <span class="p">(</span><span class="n">elt_type</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">number</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s2">&quot;Geometry.Points&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;Geometry.Curves&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;Mesh.ColorCarousel&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">quality</span><span class="p">:</span>
            <span class="n">number</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s2">&quot;Mesh.SurfaceFaces&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">set_display</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>
        <span class="n">split_view</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nview</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nview</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span>

        <span class="c1"># output</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">GUI</span><span class="p">:</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Writes** all output files: &lt;file&gt;.geo_unrolled, &lt;file&gt;.log, &lt;file&gt;.mesh and</span>
<span class="sd">        returns the mesh filename.</span>

<span class="sd">        - mesh_dir: the name of the directory where all gmsh generated files are saved.</span>
<span class="sd">        - format: whether to perform medit formatting (True) or not (False) of the mesh.</span>
<span class="sd">        - self.outfile: the core name of the outputed files e.g. outfile.log,</span>
<span class="sd">           outfile.mesh, etc.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mesh_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outdir</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">mesh_dir</span> <span class="k">else</span> <span class="n">mesh_dir</span>
        <span class="n">check_dir</span><span class="p">(</span><span class="n">mesh_dir</span><span class="p">)</span>
        <span class="c1"># .geo</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;writing </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">outfile</span><span class="si">}</span><span class="s2">.geo_unrolled to </span><span class="si">{</span><span class="n">mesh_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mesh_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outfile</span> <span class="o">+</span> <span class="s2">&quot;.geo_unrolled&quot;</span><span class="p">))</span>
        <span class="c1"># .mesh</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;writing </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">outfile</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_format</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">mesh_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mesh_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outfile</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_format</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
        <span class="c1"># medit formatting</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_format</span> <span class="o">==</span> <span class="s2">&quot;mesh&quot;</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;medit formatting of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">outfile</span><span class="si">}</span><span class="s2">.mesh&quot;</span><span class="p">)</span>
            <span class="n">mesh_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mesh_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outfile</span> <span class="o">+</span> <span class="s2">&quot;.mesh&quot;</span><span class="p">)</span>
            <span class="n">mesh</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">mesh_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extrusion_layers</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reformat_2d</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">non_corner_tags</span><span class="p">:</span>
                <span class="n">mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_corners</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span><span class="p">:</span>
                <span class="n">mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">merge_refs</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">mesh_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ftw</span><span class="p">:</span>
                <span class="n">ftw</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mesh</span><span class="p">))</span>
        <span class="c1"># .log</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">log_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mesh_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outfile</span> <span class="o">+</span> <span class="s2">&quot;.log&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;writing </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">outfile</span><span class="si">}</span><span class="s2">.log to </span><span class="si">{</span><span class="n">mesh_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">log_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">log</span><span class="p">))</span>
        <span class="c1"># print summary</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">log</span> <span class="k">if</span> <span class="s2">&quot;nodes&quot;</span> <span class="ow">in</span> <span class="n">line</span> <span class="ow">and</span> <span class="s2">&quot;elements&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">6</span><span class="p">:]</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GMSH summary: </span><span class="si">{</span><span class="n">summary</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># close gmsh</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meshfile</span><span class="p">(</span><span class="n">mesh_dir</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reformat_2d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Fix** gmsh default .mesh format in 2D.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">get_mesh_kwd</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s2">&quot;Dimension&quot;</span><span class="p">)</span>
        <span class="n">mesh</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; Dimension 2&quot;</span>
        <span class="k">del</span> <span class="n">mesh</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

        <span class="n">vert_idx</span> <span class="o">=</span> <span class="n">get_mesh_kwd</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s2">&quot;Vertices&quot;</span><span class="p">)</span>
        <span class="n">n_vert</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="n">vert_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">vert_idx</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">vert_idx</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">n_vert</span><span class="p">):</span>
            <span class="n">line_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">mesh</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
            <span class="n">mesh</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">line_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;20</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> \
                       <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">line_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;20</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> \
                       <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">line_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="si">:</span><span class="s2">&gt;20</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">mesh</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_corners</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Adds** Corners at the end of the mesh file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c_vert</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;non-corner tags: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">non_corner_tags</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">vert_idx</span> <span class="o">=</span> <span class="n">get_mesh_kwd</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s2">&quot;Vertices&quot;</span><span class="p">)</span>
        <span class="n">n_vert</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="n">vert_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">v_id</span><span class="p">,</span> <span class="nb">id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">vert_idx</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">vert_idx</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">n_vert</span><span class="p">)):</span>
            <span class="n">line_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">mesh</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">line_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">non_corner_tags</span><span class="p">:</span>
                <span class="n">c_vert</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v_id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">mesh</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;Corners&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c_vert</span><span class="p">))]</span> <span class="o">+</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">c_vert</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;End&quot;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">mesh</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">merge_refs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Merges** the periodic boundaries references on each side of the domain.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;top tags: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span><span class="si">}</span><span class="s2"> merged in ref: </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;bottom tags: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span><span class="si">}</span><span class="s2"> merged in ref: </span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">vert_idx</span> <span class="o">=</span> <span class="n">get_mesh_kwd</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s2">&quot;Vertices&quot;</span><span class="p">)</span>
        <span class="n">n_vert</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="n">vert_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">vert_idx</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">vert_idx</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">n_vert</span><span class="p">):</span>
            <span class="n">line_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">mesh</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">line_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span><span class="p">:</span>
                <span class="n">line_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="n">line_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span><span class="p">:</span>
                <span class="n">line_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span><span class="p">)</span>
            <span class="n">mesh</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">line_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;20</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> \
                       <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">line_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;20</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> \
                       <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">line_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="si">:</span><span class="s2">&gt;20</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">edge_idx</span> <span class="o">=</span> <span class="n">get_mesh_kwd</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s2">&quot;Edges&quot;</span><span class="p">)</span>
        <span class="n">n_edges</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="n">edge_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">edge_idx</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">edge_idx</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">n_edges</span><span class="p">):</span>
            <span class="n">line_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">mesh</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
            <span class="k">if</span> <span class="n">line_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span><span class="p">:</span>
                <span class="n">line_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">line_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span><span class="p">:</span>
                <span class="n">line_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span><span class="p">)</span>
            <span class="n">mesh</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">line_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">line_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">line_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">mesh</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_meshfile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Returns** the path to the generated mesh.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mesh_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outfile</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_format</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">process_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Makes sure the config file contains the required information.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">build_2dmesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Builds the surface mesh of the computational domain.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build_3dmesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Builds a 3D mesh by extrusion</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;build_3dmesh method not implemented&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="mesh.mesh.Mesh.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">datfile</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Instantiates the abstract Mesh object.</p>
<p><strong>Input</strong></p>
<ul>
<li>config (dict): the config file dictionary.</li>
<li>dat_file (str): path to input_geometry.dat.</li>
</ul>
<p><strong>Inner</strong></p>
<ul>
<li>outdir (str): path/to/outputdirectory</li>
<li>outfile (str): the core name of all outputed files e.g. outfile.log, outfile.mesh, etc.</li>
<li>header (int): the number of header lines in dat_file.</li>
<li>geom_scale (float): geometry scaling factor.</li>
<li>mesh_format (str): the mesh format (mesh or cgns).</li>
<li>bl (bool): whether to mesh the boundary layer (True) or not (False).</li>
<li>bl_thickness (float): the BL meshing cumulated thickness.</li>
<li>bl_ratio (float): the BL meshing growth ratio.</li>
<li>bl_size (float): the BL first element size.</li>
<li>bl_fan_elements (int): the number of BL fan elements.</li>
<li>mesh_order (int): the order of the mesh.</li>
<li>structured (bool): whether to recombine triangles (True) or not (False).</li>
<li>extrusion_layers (int): the number of extrusion layers when generating a 3D mesh.</li>
<li>extrusion_size (float): the total size of the extruded layers.</li>
<li>GUI (bool): whether to launch gmsh GUI (True) or not (False).</li>
<li>nview (int): the number of sub-windows in gmsh GUI.</li>
<li>quality (bool): whether to display quality metrics in gmsh GUI (True) or not (False).</li>
<li>pts (list[list[float]]): the geometry coordinates.</li>
<li>surf_tag (list[int]): flow-field elements tags used to recombine the mesh if structured.</li>
<li>non_corner_tags (list[int]): non-corner physical entity tags used to define 'Corners'.</li>
<li>lower_tag (list[int]): lower periodic tags to be identified as one.</li>
<li>lower_tag (list[int]): upper periodic tags to be identified as one.</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>aero_optim/mesh/mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">datfile</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instantiates the abstract Mesh object.</span>

<span class="sd">    **Input**</span>

<span class="sd">    - config (dict): the config file dictionary.</span>
<span class="sd">    - dat_file (str): path to input_geometry.dat.</span>

<span class="sd">    **Inner**</span>

<span class="sd">    - outdir (str): path/to/outputdirectory</span>
<span class="sd">    - outfile (str): the core name of all outputed files e.g. outfile.log, outfile.mesh, etc.</span>
<span class="sd">    - header (int): the number of header lines in dat_file.</span>
<span class="sd">    - geom_scale (float): geometry scaling factor.</span>
<span class="sd">    - mesh_format (str): the mesh format (mesh or cgns).</span>
<span class="sd">    - bl (bool): whether to mesh the boundary layer (True) or not (False).</span>
<span class="sd">    - bl_thickness (float): the BL meshing cumulated thickness.</span>
<span class="sd">    - bl_ratio (float): the BL meshing growth ratio.</span>
<span class="sd">    - bl_size (float): the BL first element size.</span>
<span class="sd">    - bl_fan_elements (int): the number of BL fan elements.</span>
<span class="sd">    - mesh_order (int): the order of the mesh.</span>
<span class="sd">    - structured (bool): whether to recombine triangles (True) or not (False).</span>
<span class="sd">    - extrusion_layers (int): the number of extrusion layers when generating a 3D mesh.</span>
<span class="sd">    - extrusion_size (float): the total size of the extruded layers.</span>
<span class="sd">    - GUI (bool): whether to launch gmsh GUI (True) or not (False).</span>
<span class="sd">    - nview (int): the number of sub-windows in gmsh GUI.</span>
<span class="sd">    - quality (bool): whether to display quality metrics in gmsh GUI (True) or not (False).</span>
<span class="sd">    - pts (list[list[float]]): the geometry coordinates.</span>
<span class="sd">    - surf_tag (list[int]): flow-field elements tags used to recombine the mesh if structured.</span>
<span class="sd">    - non_corner_tags (list[int]): non-corner physical entity tags used to define &#39;Corners&#39;.</span>
<span class="sd">    - lower_tag (list[int]): lower periodic tags to be identified as one.</span>
<span class="sd">    - lower_tag (list[int]): upper periodic tags to be identified as one.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">process_config</span><span class="p">()</span>
    <span class="c1"># study params</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dat_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">datfile</span> <span class="k">if</span> <span class="n">datfile</span> <span class="k">else</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;study&quot;</span><span class="p">][</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">outdir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;study&quot;</span><span class="p">][</span><span class="s2">&quot;outdir&quot;</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">outfile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;study&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;outfile&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dat_file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
    <span class="c1"># mesh params (geom, format &amp; boundary layer)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;header&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">geom_scale</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;scale&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mesh_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mesh_format&quot;</span><span class="p">,</span> <span class="s2">&quot;mesh&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bl</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bl_thickness</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;bl_thickness&quot;</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bl_ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;bl_ratio&quot;</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bl_size</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;bl_size&quot;</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bl_fan_elements</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;bl_fan_elements&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mesh_order</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;order&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="c1"># mesh params (3d extrusion)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">structured</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;structured&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">extrusion_layers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extrusion_layers&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">extrusion_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extrusion_size&quot;</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
    <span class="c1"># gui options</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">GUI</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;view&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;GUI&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nview</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;view&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nview&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">quality</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;view&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;quality&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="c1"># geometry coordinates loading</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="n">from_dat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dat_file</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom_scale</span><span class="p">)</span>
    <span class="c1"># flow-field and non-corner tags (for recombination and corners definition)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">surf_tag</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">non_corner_tags</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesh.mesh.Mesh.add_corners" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_corners</span><span class="p">(</span><span class="n">mesh</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

</h4>


    <div class="doc doc-contents ">

        <p><strong>Adds</strong> Corners at the end of the mesh file.</p>


            <details class="quote">
              <summary>Source code in <code>aero_optim/mesh/mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_corners</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Adds** Corners at the end of the mesh file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c_vert</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;non-corner tags: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">non_corner_tags</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">vert_idx</span> <span class="o">=</span> <span class="n">get_mesh_kwd</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s2">&quot;Vertices&quot;</span><span class="p">)</span>
    <span class="n">n_vert</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="n">vert_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">v_id</span><span class="p">,</span> <span class="nb">id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">vert_idx</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">vert_idx</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">n_vert</span><span class="p">)):</span>
        <span class="n">line_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">mesh</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">line_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">non_corner_tags</span><span class="p">:</span>
            <span class="n">c_vert</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v_id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">mesh</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;Corners&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c_vert</span><span class="p">))]</span> <span class="o">+</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">c_vert</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;End&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">mesh</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesh.mesh.Mesh.build_2dmesh" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_2dmesh</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Builds the surface mesh of the computational domain.</p>


            <details class="quote">
              <summary>Source code in <code>aero_optim/mesh/mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">build_2dmesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds the surface mesh of the computational domain.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesh.mesh.Mesh.build_3dmesh" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_3dmesh</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Builds a 3D mesh by extrusion</p>


            <details class="quote">
              <summary>Source code in <code>aero_optim/mesh/mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build_3dmesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds a 3D mesh by extrusion</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;build_3dmesh method not implemented&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesh.mesh.Mesh.build_mesh" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_mesh</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p><strong>Defines</strong> the gmsh routine.</p>


            <details class="quote">
              <summary>Source code in <code>aero_optim/mesh/mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Defines** the gmsh routine.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s1">&#39;General.Terminal&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">build_2dmesh</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">build_3dmesh</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extrusion_layers</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">structured</span><span class="p">:</span>
        <span class="p">[</span><span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setRecombine</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">id</span><span class="p">))</span> <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">surf_tag</span><span class="p">]</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extrusion_layers</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_order</span><span class="p">:</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setOrder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_order</span><span class="p">)</span>

    <span class="c1"># visualization</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">quality</span><span class="p">:</span>
        <span class="n">plot_quality</span><span class="p">()</span>
    <span class="n">elt_type</span> <span class="o">=</span> <span class="s2">&quot;Mesh.Triangles&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">structured</span> <span class="k">else</span> <span class="s2">&quot;Mesh.Quadrangles&quot;</span>
    <span class="n">color</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;General.BackgroundGradient&quot;</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
        <span class="p">(</span><span class="n">elt_type</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">number</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;Geometry.Points&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;Geometry.Curves&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;Mesh.ColorCarousel&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">quality</span><span class="p">:</span>
        <span class="n">number</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s2">&quot;Mesh.SurfaceFaces&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">set_display</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>
    <span class="n">split_view</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nview</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nview</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span>

    <span class="c1"># output</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">GUI</span><span class="p">:</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesh.mesh.Mesh.get_meshfile" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_meshfile</span><span class="p">(</span><span class="n">mesh_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

</h4>


    <div class="doc doc-contents ">

        <p><strong>Returns</strong> the path to the generated mesh.</p>


            <details class="quote">
              <summary>Source code in <code>aero_optim/mesh/mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_meshfile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Returns** the path to the generated mesh.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mesh_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outfile</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_format</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesh.mesh.Mesh.get_nlayer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_nlayer</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span></code>

</h4>


    <div class="doc doc-contents ">

        <p><strong>Returns</strong> the number of layers required to reach bl_thickness given the growth bl_ratio
and the first element size bl_size.</p>


            <details class="quote">
              <summary>Source code in <code>aero_optim/mesh/mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_nlayer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Returns** the number of layers required to reach bl_thickness given the growth bl_ratio</span>
<span class="sd">    and the first element size bl_size.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span>
        <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl_thickness</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl_ratio</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl_size</span><span class="p">)</span>
        <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bl_ratio</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesh.mesh.Mesh.merge_refs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">merge_refs</span><span class="p">(</span><span class="n">mesh</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

</h4>


    <div class="doc doc-contents ">

        <p><strong>Merges</strong> the periodic boundaries references on each side of the domain.</p>


            <details class="quote">
              <summary>Source code in <code>aero_optim/mesh/mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">merge_refs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Merges** the periodic boundaries references on each side of the domain.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;top tags: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span><span class="si">}</span><span class="s2"> merged in ref: </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;bottom tags: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span><span class="si">}</span><span class="s2"> merged in ref: </span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">vert_idx</span> <span class="o">=</span> <span class="n">get_mesh_kwd</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s2">&quot;Vertices&quot;</span><span class="p">)</span>
    <span class="n">n_vert</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="n">vert_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">vert_idx</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">vert_idx</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">n_vert</span><span class="p">):</span>
        <span class="n">line_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">mesh</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">line_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span><span class="p">:</span>
            <span class="n">line_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="n">line_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span><span class="p">:</span>
            <span class="n">line_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span><span class="p">)</span>
        <span class="n">mesh</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">line_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;20</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> \
                   <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">line_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;20</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> \
                   <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">line_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="si">:</span><span class="s2">&gt;20</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="n">edge_idx</span> <span class="o">=</span> <span class="n">get_mesh_kwd</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s2">&quot;Edges&quot;</span><span class="p">)</span>
    <span class="n">n_edges</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="n">edge_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">edge_idx</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">edge_idx</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">n_edges</span><span class="p">):</span>
        <span class="n">line_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">mesh</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
        <span class="k">if</span> <span class="n">line_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span><span class="p">:</span>
            <span class="n">line_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">line_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span><span class="p">:</span>
            <span class="n">line_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span><span class="p">)</span>
        <span class="n">mesh</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">line_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">line_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">line_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">mesh</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesh.mesh.Mesh.process_config" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_config</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Makes sure the config file contains the required information.</p>


            <details class="quote">
              <summary>Source code in <code>aero_optim/mesh/mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">process_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes sure the config file contains the required information.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesh.mesh.Mesh.reformat_2d" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reformat_2d</span><span class="p">(</span><span class="n">mesh</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

</h4>


    <div class="doc doc-contents ">

        <p><strong>Fix</strong> gmsh default .mesh format in 2D.</p>


            <details class="quote">
              <summary>Source code in <code>aero_optim/mesh/mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reformat_2d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Fix** gmsh default .mesh format in 2D.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">get_mesh_kwd</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s2">&quot;Dimension&quot;</span><span class="p">)</span>
    <span class="n">mesh</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; Dimension 2&quot;</span>
    <span class="k">del</span> <span class="n">mesh</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

    <span class="n">vert_idx</span> <span class="o">=</span> <span class="n">get_mesh_kwd</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s2">&quot;Vertices&quot;</span><span class="p">)</span>
    <span class="n">n_vert</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="n">vert_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">vert_idx</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">vert_idx</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">n_vert</span><span class="p">):</span>
        <span class="n">line_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">mesh</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
        <span class="n">mesh</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">line_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;20</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> \
                   <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">line_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;20</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> \
                   <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">line_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="si">:</span><span class="s2">&gt;20</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">mesh</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesh.mesh.Mesh.write_mesh" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_mesh</span><span class="p">(</span><span class="n">mesh_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

</h4>


    <div class="doc doc-contents ">

        <p><strong>Writes</strong> all output files: <file>.geo_unrolled, <file>.log, <file>.mesh and
returns the mesh filename.</p>
<ul>
<li>mesh_dir: the name of the directory where all gmsh generated files are saved.</li>
<li>format: whether to perform medit formatting (True) or not (False) of the mesh.</li>
<li>self.outfile: the core name of the outputed files e.g. outfile.log,
   outfile.mesh, etc.</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>aero_optim/mesh/mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">write_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Writes** all output files: &lt;file&gt;.geo_unrolled, &lt;file&gt;.log, &lt;file&gt;.mesh and</span>
<span class="sd">    returns the mesh filename.</span>

<span class="sd">    - mesh_dir: the name of the directory where all gmsh generated files are saved.</span>
<span class="sd">    - format: whether to perform medit formatting (True) or not (False) of the mesh.</span>
<span class="sd">    - self.outfile: the core name of the outputed files e.g. outfile.log,</span>
<span class="sd">       outfile.mesh, etc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mesh_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outdir</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">mesh_dir</span> <span class="k">else</span> <span class="n">mesh_dir</span>
    <span class="n">check_dir</span><span class="p">(</span><span class="n">mesh_dir</span><span class="p">)</span>
    <span class="c1"># .geo</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;writing </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">outfile</span><span class="si">}</span><span class="s2">.geo_unrolled to </span><span class="si">{</span><span class="n">mesh_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mesh_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outfile</span> <span class="o">+</span> <span class="s2">&quot;.geo_unrolled&quot;</span><span class="p">))</span>
    <span class="c1"># .mesh</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;writing </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">outfile</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_format</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">mesh_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mesh_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outfile</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_format</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
    <span class="c1"># medit formatting</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_format</span> <span class="o">==</span> <span class="s2">&quot;mesh&quot;</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;medit formatting of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">outfile</span><span class="si">}</span><span class="s2">.mesh&quot;</span><span class="p">)</span>
        <span class="n">mesh_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mesh_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outfile</span> <span class="o">+</span> <span class="s2">&quot;.mesh&quot;</span><span class="p">)</span>
        <span class="n">mesh</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">mesh_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extrusion_layers</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reformat_2d</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">non_corner_tags</span><span class="p">:</span>
            <span class="n">mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_corners</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span><span class="p">:</span>
            <span class="n">mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">merge_refs</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">mesh_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ftw</span><span class="p">:</span>
            <span class="n">ftw</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mesh</span><span class="p">))</span>
    <span class="c1"># .log</span>
    <span class="n">log</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="n">log_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mesh_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outfile</span> <span class="o">+</span> <span class="s2">&quot;.log&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;writing </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">outfile</span><span class="si">}</span><span class="s2">.log to </span><span class="si">{</span><span class="n">mesh_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">log_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">log</span><span class="p">))</span>
    <span class="c1"># print summary</span>
    <span class="n">summary</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">log</span> <span class="k">if</span> <span class="s2">&quot;nodes&quot;</span> <span class="ow">in</span> <span class="n">line</span> <span class="ow">and</span> <span class="s2">&quot;elements&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">6</span><span class="p">:]</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GMSH summary: </span><span class="si">{</span><span class="n">summary</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># close gmsh</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meshfile</span><span class="p">(</span><span class="n">mesh_dir</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><hr style="border:1px solid grey">



<div class="doc doc-object doc-class">



<h3 id="mesh.naca_base_mesh.NACABaseMesh" class="doc doc-heading">
            <code>mesh.naca_base_mesh.NACABaseMesh</code>


</h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="aero_optim.mesh.mesh.Mesh">Mesh</span></code></p>


        <p>This class implements a meshing routine for a naca profile.</p>
<p>The computational domain has the following structure:</p>
<pre><code>            pt_hi_inlet
               !   top_side
               !      !
            *  * ------------- * pt_hi_outlet
      *  *  *                  |
   *  *                        |
   *                           |
*  *                           |
*                              |
*   &lt;- arc_inlet               | &lt;- outlet
*                              |
*  *                           |
   *                           |
   *  *                        |
      *  *  *                  |
            *  * ------------- * pt_low_outlet
               !        !
               !   bottom_side
            pt_low_inlet
</code></pre>







              <details class="quote">
                <summary>Source code in <code>aero_optim/mesh/naca_base_mesh.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">NACABaseMesh</span><span class="p">(</span><span class="n">Mesh</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class implements a meshing routine for a naca profile.</span>

<span class="sd">    The computational domain has the following structure:</span>

<span class="sd">                    pt_hi_inlet</span>
<span class="sd">                       !   top_side</span>
<span class="sd">                       !      !</span>
<span class="sd">                    *  * ------------- * pt_hi_outlet</span>
<span class="sd">              *  *  *                  |</span>
<span class="sd">           *  *                        |</span>
<span class="sd">           *                           |</span>
<span class="sd">        *  *                           |</span>
<span class="sd">        *                              |</span>
<span class="sd">        *   &lt;- arc_inlet               | &lt;- outlet</span>
<span class="sd">        *                              |</span>
<span class="sd">        *  *                           |</span>
<span class="sd">           *                           |</span>
<span class="sd">           *  *                        |</span>
<span class="sd">              *  *  *                  |</span>
<span class="sd">                    *  * ------------- * pt_low_outlet</span>
<span class="sd">                       !        !</span>
<span class="sd">                       !   bottom_side</span>
<span class="sd">                    pt_low_inlet</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">datfile</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instantiates the NACABaseMesh object.</span>

<span class="sd">        **Input**</span>

<span class="sd">        - config (dict): the config file dictionary.</span>
<span class="sd">        - dat_file (str): path to input_geometry.dat.</span>

<span class="sd">        **Inner**</span>

<span class="sd">        - dinlet (float): the radius of the inlet semi-circle.</span>
<span class="sd">        - doutlet (float): the distance between the airfoil trailing edge and the outlet.</span>
<span class="sd">        - offset (int): the leading edge portion defined in number of points from the leading edge.</span>
<span class="sd">        - nodes_inlet (int): the number of nodes to mesh the inlet.</span>
<span class="sd">        - nodes_outlet (int): the number of nodes to mesh the outlet.</span>
<span class="sd">        - snodes (int): the number of nodes to mesh the top and bottom sides.</span>
<span class="sd">        - le (int): the number of nodes to mesh the airfoil leading edge portion.</span>
<span class="sd">        - low (int): the number of nodes to mesh the airfoil trailing edge lower portion.</span>
<span class="sd">        - up (int): the number of nodes to mesh the airfoil trailing edge upper portion.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">datfile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dinlet</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;domain&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inlet&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doutlet</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;domain&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;outlet&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;domain&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;le_offset&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_inlet</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodes_inlet&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_outlet</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodes_outlet&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">snodes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;side_nodes&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">le</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;le&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">low</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;low&quot;</span><span class="p">,</span> <span class="mi">70</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;up&quot;</span><span class="p">,</span> <span class="mi">70</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;processing config..&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;domain&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">]:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;no &lt;domain&gt; entry in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;gmsh&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, empty entry added&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;domain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="s2">&quot;inlet&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;domain&quot;</span><span class="p">]:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;no &lt;inlet&gt; entry in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;gmsh&#39;</span><span class="p">][</span><span class="s1">&#39;domain&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;outlet&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;domain&quot;</span><span class="p">]:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;no &lt;outlet&gt; entry in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;gmsh&#39;</span><span class="p">][</span><span class="s1">&#39;domain&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">split_naca</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Returns** the upper and lower parts of the airfoil as ordered lists (wrt the x axis).</span>

<span class="sd">        Note:</span>
<span class="sd">            the trailing and leading edges are voluntarily excluded from both parts</span>
<span class="sd">            since the geometry is closed and these points must each have a unique tag.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">idx_le</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_te</span><span class="p">)</span>
        <span class="n">end</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">idx_le</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_te</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">max</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]])</span>
            <span class="o">&gt;</span> <span class="nb">max</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[:</span><span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="n">end</span><span class="p">:]])</span>
        <span class="p">):</span>
            <span class="n">upper</span> <span class="o">=</span> <span class="p">[[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="n">end</span><span class="p">]]</span>
            <span class="n">lower</span> <span class="o">=</span> <span class="p">[[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[:</span><span class="n">start</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lower</span> <span class="o">=</span> <span class="p">[[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="n">end</span><span class="p">]]</span>
            <span class="n">upper</span> <span class="o">=</span> <span class="p">[[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[:</span><span class="n">start</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]]</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">upper</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">upper</span><span class="p">,</span> <span class="n">lower</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build_bl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">naca_tag</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">te_tag</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Builds** the boundary layer around the airfoil.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;BoundaryLayer&#39;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumbers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;CurvesList&#39;</span><span class="p">,</span> <span class="n">naca_tag</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;Size&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl_size</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;Ratio&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl_ratio</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;Quads&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structured</span><span class="p">))</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;Thickness&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl_thickness</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s1">&#39;Mesh.BoundaryLayerFanElements&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl_fan_elements</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumbers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;FanPointsList&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">te_tag</span><span class="p">])</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setAsBoundaryLayer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build_2dmesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Builds** the surface mesh of the computational domain.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_le</span> <span class="o">=</span> <span class="nb">min</span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">))</span>
        <span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_te</span> <span class="o">=</span> <span class="nb">max</span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">))</span>
        <span class="n">u_side</span><span class="p">,</span> <span class="n">l_side</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_naca</span><span class="p">()</span>

        <span class="c1"># add points and lines for the naca lower and upper parts</span>
        <span class="n">x_le</span><span class="p">,</span> <span class="n">y_le</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">idx_le</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">x_te</span><span class="p">,</span> <span class="n">y_te</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">idx_te</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">te_tag</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x_te</span><span class="p">,</span> <span class="n">y_te</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">le_tag</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x_le</span><span class="p">,</span> <span class="n">y_le</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">pt_u</span> <span class="o">=</span> <span class="p">[</span><span class="n">te_tag</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">u_side</span><span class="p">]</span>
        <span class="n">pt_l</span> <span class="o">=</span> <span class="p">[</span><span class="n">le_tag</span><span class="p">]</span> <span class="o">+</span>\
               <span class="p">[</span><span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">l_side</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">te_tag</span><span class="p">]</span>

        <span class="c1"># airfoil boundary</span>
        <span class="n">spline_low</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_l</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">:],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">spline_le</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_u</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">:]</span> <span class="o">+</span> <span class="n">pt_l</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">spline_up</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_u</span><span class="p">[:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spline_low</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">low</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spline_le</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">le</span><span class="p">,</span> <span class="s2">&quot;Bump&quot;</span><span class="p">,</span> <span class="mf">2.</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spline_up</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">naca_loop</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">([</span><span class="n">spline_low</span><span class="p">,</span> <span class="n">spline_le</span><span class="p">,</span> <span class="n">spline_up</span><span class="p">])</span>

        <span class="c1"># boundary layer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build_bl</span><span class="p">([</span><span class="n">spline_low</span><span class="p">,</span> <span class="n">spline_le</span><span class="p">,</span> <span class="n">spline_up</span><span class="p">],</span> <span class="n">te_tag</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl</span> <span class="k">else</span> <span class="mi">0</span>

        <span class="c1"># construction points</span>
        <span class="n">pt_hi_inlet</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x_te</span><span class="p">,</span> <span class="n">y_te</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dinlet</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">pt_low_inlet</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x_te</span><span class="p">,</span> <span class="n">y_te</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dinlet</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">pt_hi_outlet</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x_te</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">doutlet</span><span class="p">,</span> <span class="n">y_te</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dinlet</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">pt_low_outlet</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x_te</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">doutlet</span><span class="p">,</span> <span class="n">y_te</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dinlet</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>

        <span class="c1"># non-blade boundary lines</span>
        <span class="n">arc_inlet</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCircleArc</span><span class="p">(</span><span class="n">pt_hi_inlet</span><span class="p">,</span> <span class="n">te_tag</span><span class="p">,</span> <span class="n">pt_low_inlet</span><span class="p">)</span>
        <span class="n">top_side</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_hi_inlet</span><span class="p">,</span> <span class="n">pt_hi_outlet</span><span class="p">)</span>
        <span class="n">bottom_side</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_low_outlet</span><span class="p">,</span> <span class="n">pt_low_inlet</span><span class="p">)</span>
        <span class="n">outlet</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_hi_outlet</span><span class="p">,</span> <span class="n">pt_low_outlet</span><span class="p">)</span>

        <span class="c1"># transfinite curves on non-blade boundaries</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">arc_inlet</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_inlet</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">top_side</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">snodes</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">bottom_side</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">snodes</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">outlet</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_outlet</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># closed curve loop and computational domain surface definition</span>
        <span class="n">cloop</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">arc_inlet</span><span class="p">,</span> <span class="n">top_side</span><span class="p">,</span> <span class="n">outlet</span><span class="p">,</span> <span class="n">bottom_side</span><span class="p">]</span>
        <span class="n">boundary_loop</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">(</span><span class="n">cloop</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surf_tag</span> <span class="o">=</span> <span class="p">[</span><span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPlaneSurface</span><span class="p">([</span><span class="o">-</span><span class="n">boundary_loop</span><span class="p">,</span> <span class="o">-</span><span class="n">naca_loop</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1000</span><span class="p">)]</span>

        <span class="c1"># define physical groups for boundary conditions</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">spline_low</span><span class="p">,</span> <span class="n">spline_le</span><span class="p">,</span> <span class="n">spline_up</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BC: Wall tags are </span><span class="si">{</span><span class="p">[</span><span class="n">spline_low</span><span class="p">,</span><span class="w"> </span><span class="n">spline_le</span><span class="p">,</span><span class="w"> </span><span class="n">spline_up</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">arc_inlet</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BC: Inlet tags are </span><span class="si">{</span><span class="p">[</span><span class="n">arc_inlet</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">outlet</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BC: Outlet tags are </span><span class="si">{</span><span class="p">[</span><span class="n">outlet</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">top_side</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BC: Top tags are </span><span class="si">{</span><span class="p">[</span><span class="n">top_side</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">bottom_side</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BC: Bottom tags are </span><span class="si">{</span><span class="p">[</span><span class="n">bottom_side</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">surf_tag</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="mesh.naca_base_mesh.NACABaseMesh.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">datfile</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Instantiates the NACABaseMesh object.</p>
<p><strong>Input</strong></p>
<ul>
<li>config (dict): the config file dictionary.</li>
<li>dat_file (str): path to input_geometry.dat.</li>
</ul>
<p><strong>Inner</strong></p>
<ul>
<li>dinlet (float): the radius of the inlet semi-circle.</li>
<li>doutlet (float): the distance between the airfoil trailing edge and the outlet.</li>
<li>offset (int): the leading edge portion defined in number of points from the leading edge.</li>
<li>nodes_inlet (int): the number of nodes to mesh the inlet.</li>
<li>nodes_outlet (int): the number of nodes to mesh the outlet.</li>
<li>snodes (int): the number of nodes to mesh the top and bottom sides.</li>
<li>le (int): the number of nodes to mesh the airfoil leading edge portion.</li>
<li>low (int): the number of nodes to mesh the airfoil trailing edge lower portion.</li>
<li>up (int): the number of nodes to mesh the airfoil trailing edge upper portion.</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>aero_optim/mesh/naca_base_mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">datfile</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instantiates the NACABaseMesh object.</span>

<span class="sd">    **Input**</span>

<span class="sd">    - config (dict): the config file dictionary.</span>
<span class="sd">    - dat_file (str): path to input_geometry.dat.</span>

<span class="sd">    **Inner**</span>

<span class="sd">    - dinlet (float): the radius of the inlet semi-circle.</span>
<span class="sd">    - doutlet (float): the distance between the airfoil trailing edge and the outlet.</span>
<span class="sd">    - offset (int): the leading edge portion defined in number of points from the leading edge.</span>
<span class="sd">    - nodes_inlet (int): the number of nodes to mesh the inlet.</span>
<span class="sd">    - nodes_outlet (int): the number of nodes to mesh the outlet.</span>
<span class="sd">    - snodes (int): the number of nodes to mesh the top and bottom sides.</span>
<span class="sd">    - le (int): the number of nodes to mesh the airfoil leading edge portion.</span>
<span class="sd">    - low (int): the number of nodes to mesh the airfoil trailing edge lower portion.</span>
<span class="sd">    - up (int): the number of nodes to mesh the airfoil trailing edge upper portion.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">datfile</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dinlet</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;domain&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inlet&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">doutlet</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;domain&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;outlet&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;domain&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;le_offset&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nodes_inlet</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodes_inlet&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nodes_outlet</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodes_outlet&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">snodes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;side_nodes&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">le</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;le&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">low</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;low&quot;</span><span class="p">,</span> <span class="mi">70</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;up&quot;</span><span class="p">,</span> <span class="mi">70</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesh.naca_base_mesh.NACABaseMesh.build_2dmesh" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_2dmesh</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p><strong>Builds</strong> the surface mesh of the computational domain.</p>


            <details class="quote">
              <summary>Source code in <code>aero_optim/mesh/naca_base_mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build_2dmesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Builds** the surface mesh of the computational domain.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_le</span> <span class="o">=</span> <span class="nb">min</span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">))</span>
    <span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_te</span> <span class="o">=</span> <span class="nb">max</span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">))</span>
    <span class="n">u_side</span><span class="p">,</span> <span class="n">l_side</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_naca</span><span class="p">()</span>

    <span class="c1"># add points and lines for the naca lower and upper parts</span>
    <span class="n">x_le</span><span class="p">,</span> <span class="n">y_le</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">idx_le</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">x_te</span><span class="p">,</span> <span class="n">y_te</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">idx_te</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">te_tag</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x_te</span><span class="p">,</span> <span class="n">y_te</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">le_tag</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x_le</span><span class="p">,</span> <span class="n">y_le</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">pt_u</span> <span class="o">=</span> <span class="p">[</span><span class="n">te_tag</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">u_side</span><span class="p">]</span>
    <span class="n">pt_l</span> <span class="o">=</span> <span class="p">[</span><span class="n">le_tag</span><span class="p">]</span> <span class="o">+</span>\
           <span class="p">[</span><span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">l_side</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">te_tag</span><span class="p">]</span>

    <span class="c1"># airfoil boundary</span>
    <span class="n">spline_low</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_l</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">:],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">spline_le</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_u</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">:]</span> <span class="o">+</span> <span class="n">pt_l</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">spline_up</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_u</span><span class="p">[:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spline_low</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">low</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spline_le</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">le</span><span class="p">,</span> <span class="s2">&quot;Bump&quot;</span><span class="p">,</span> <span class="mf">2.</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spline_up</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">naca_loop</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">([</span><span class="n">spline_low</span><span class="p">,</span> <span class="n">spline_le</span><span class="p">,</span> <span class="n">spline_up</span><span class="p">])</span>

    <span class="c1"># boundary layer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">build_bl</span><span class="p">([</span><span class="n">spline_low</span><span class="p">,</span> <span class="n">spline_le</span><span class="p">,</span> <span class="n">spline_up</span><span class="p">],</span> <span class="n">te_tag</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl</span> <span class="k">else</span> <span class="mi">0</span>

    <span class="c1"># construction points</span>
    <span class="n">pt_hi_inlet</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x_te</span><span class="p">,</span> <span class="n">y_te</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dinlet</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">pt_low_inlet</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x_te</span><span class="p">,</span> <span class="n">y_te</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dinlet</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">pt_hi_outlet</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x_te</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">doutlet</span><span class="p">,</span> <span class="n">y_te</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dinlet</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">pt_low_outlet</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x_te</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">doutlet</span><span class="p">,</span> <span class="n">y_te</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dinlet</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>

    <span class="c1"># non-blade boundary lines</span>
    <span class="n">arc_inlet</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCircleArc</span><span class="p">(</span><span class="n">pt_hi_inlet</span><span class="p">,</span> <span class="n">te_tag</span><span class="p">,</span> <span class="n">pt_low_inlet</span><span class="p">)</span>
    <span class="n">top_side</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_hi_inlet</span><span class="p">,</span> <span class="n">pt_hi_outlet</span><span class="p">)</span>
    <span class="n">bottom_side</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_low_outlet</span><span class="p">,</span> <span class="n">pt_low_inlet</span><span class="p">)</span>
    <span class="n">outlet</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_hi_outlet</span><span class="p">,</span> <span class="n">pt_low_outlet</span><span class="p">)</span>

    <span class="c1"># transfinite curves on non-blade boundaries</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">arc_inlet</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_inlet</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">top_side</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">snodes</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">bottom_side</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">snodes</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">outlet</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_outlet</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># closed curve loop and computational domain surface definition</span>
    <span class="n">cloop</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">arc_inlet</span><span class="p">,</span> <span class="n">top_side</span><span class="p">,</span> <span class="n">outlet</span><span class="p">,</span> <span class="n">bottom_side</span><span class="p">]</span>
    <span class="n">boundary_loop</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">(</span><span class="n">cloop</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">surf_tag</span> <span class="o">=</span> <span class="p">[</span><span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPlaneSurface</span><span class="p">([</span><span class="o">-</span><span class="n">boundary_loop</span><span class="p">,</span> <span class="o">-</span><span class="n">naca_loop</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1000</span><span class="p">)]</span>

    <span class="c1"># define physical groups for boundary conditions</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">spline_low</span><span class="p">,</span> <span class="n">spline_le</span><span class="p">,</span> <span class="n">spline_up</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BC: Wall tags are </span><span class="si">{</span><span class="p">[</span><span class="n">spline_low</span><span class="p">,</span><span class="w"> </span><span class="n">spline_le</span><span class="p">,</span><span class="w"> </span><span class="n">spline_up</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">arc_inlet</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BC: Inlet tags are </span><span class="si">{</span><span class="p">[</span><span class="n">arc_inlet</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">outlet</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BC: Outlet tags are </span><span class="si">{</span><span class="p">[</span><span class="n">outlet</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">top_side</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BC: Top tags are </span><span class="si">{</span><span class="p">[</span><span class="n">top_side</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">bottom_side</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BC: Bottom tags are </span><span class="si">{</span><span class="p">[</span><span class="n">bottom_side</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">surf_tag</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesh.naca_base_mesh.NACABaseMesh.build_bl" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_bl</span><span class="p">(</span><span class="n">naca_tag</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">te_tag</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p><strong>Builds</strong> the boundary layer around the airfoil.</p>


            <details class="quote">
              <summary>Source code in <code>aero_optim/mesh/naca_base_mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build_bl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">naca_tag</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">te_tag</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Builds** the boundary layer around the airfoil.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;BoundaryLayer&#39;</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumbers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;CurvesList&#39;</span><span class="p">,</span> <span class="n">naca_tag</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;Size&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl_size</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;Ratio&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl_ratio</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;Quads&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structured</span><span class="p">))</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;Thickness&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl_thickness</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s1">&#39;Mesh.BoundaryLayerFanElements&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl_fan_elements</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumbers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;FanPointsList&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">te_tag</span><span class="p">])</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setAsBoundaryLayer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesh.naca_base_mesh.NACABaseMesh.split_naca" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">split_naca</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]</span></code>

</h4>


    <div class="doc doc-contents ">

        <p><strong>Returns</strong> the upper and lower parts of the airfoil as ordered lists (wrt the x axis).</p>


<details class="note" open>
  <summary>Note</summary>
  <p>the trailing and leading edges are voluntarily excluded from both parts
since the geometry is closed and these points must each have a unique tag.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>aero_optim/mesh/naca_base_mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">split_naca</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Returns** the upper and lower parts of the airfoil as ordered lists (wrt the x axis).</span>

<span class="sd">    Note:</span>
<span class="sd">        the trailing and leading edges are voluntarily excluded from both parts</span>
<span class="sd">        since the geometry is closed and these points must each have a unique tag.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">idx_le</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_te</span><span class="p">)</span>
    <span class="n">end</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">idx_le</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_te</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="nb">max</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]])</span>
        <span class="o">&gt;</span> <span class="nb">max</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[:</span><span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="n">end</span><span class="p">:]])</span>
    <span class="p">):</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="p">[[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="n">end</span><span class="p">]]</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="p">[[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[:</span><span class="n">start</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="p">[[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="n">end</span><span class="p">]]</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="p">[[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[:</span><span class="n">start</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]]</span>
    <span class="n">upper</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">upper</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">lower</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">upper</span><span class="p">,</span> <span class="n">lower</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><hr style="border:1px solid grey">



<div class="doc doc-object doc-class">



<h3 id="mesh.naca_block_mesh.NACABlockMesh" class="doc doc-heading">
            <code>mesh.naca_block_mesh.NACABlockMesh</code>


</h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="aero_optim.mesh.naca_base_mesh.NACABaseMesh">NACABaseMesh</span></code></p>


        <p>This class implements a blocking mesh routine for a naca profile based on:</br>
https://github.com/ComputationalDomain/CMesh_rae69ck-il</p>







              <details class="quote">
                <summary>Source code in <code>aero_optim/mesh/naca_block_mesh.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">NACABlockMesh</span><span class="p">(</span><span class="n">NACABaseMesh</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class implements a blocking mesh routine for a naca profile based on:&lt;/br&gt;</span>
<span class="sd">    https://github.com/ComputationalDomain/CMesh_rae69ck-il</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">datfile</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instantiates the BlockMesh object.</span>

<span class="sd">        **Input**</span>

<span class="sd">        - config (dict): the config file dictionary.</span>
<span class="sd">        - dat_file (str): path to input_geometry.dat.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">datfile</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build_2dmesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Builds** the surface mesh of the computational domain.</span>

<span class="sd">        **Inner**</span>

<span class="sd">        - R (float): radius of the outer circle.</span>
<span class="sd">        - d_out (float): distance to the outlet.</span>
<span class="sd">        - offset (int): offset from leading edge.</span>
<span class="sd">        - b_width (float): block_width.</span>
<span class="sd">        - n_inlet (int): nbr of lead edge &amp; inlet nodes.</span>
<span class="sd">        - r_inlet (float): bump ratio of lead edge &amp; inlet nodes.</span>
<span class="sd">        - n_vertical (int) : nbr of out &amp; verti nodes.</span>
<span class="sd">        - r_vertical (float): out &amp; vert growth.</span>
<span class="sd">        - n_airfoil (int): nbr of nodes on each sides.</span>
<span class="sd">        - r_airfoil (float): airfoil sides growth.</span>
<span class="sd">        - n_wake (int): nbr of nodes in the wake dir.</span>
<span class="sd">        - r_wake (float): wake growth.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dinlet</span>
        <span class="n">d_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doutlet</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;domain&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;le_offset&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">b_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;domain&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;block_width&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">n_inlet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;n_inlet&quot;</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
        <span class="n">r_inlet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;r_inlet&quot;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
        <span class="n">n_vertical</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;n_vertical&quot;</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
        <span class="n">r_vertical</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;r_vertical&quot;</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">0.95</span><span class="p">)</span>
        <span class="n">n_airfoil</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;n_airfoil&quot;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
        <span class="n">r_airfoil</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;r_airfoil&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">n_wake</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;n_wake&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">r_wake</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;r_wake&quot;</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">0.95</span><span class="p">)</span>

        <span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_le</span> <span class="o">=</span> <span class="nb">min</span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">))</span>
        <span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_te</span> <span class="o">=</span> <span class="nb">max</span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">))</span>
        <span class="n">u_side</span><span class="p">,</span> <span class="n">l_side</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_naca</span><span class="p">()</span>

        <span class="c1"># add points and lines for the naca lower and upper parts</span>
        <span class="n">x_le</span><span class="p">,</span> <span class="n">y_le</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">idx_le</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">x_te</span><span class="p">,</span> <span class="n">y_te</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">idx_te</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">te_tag</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x_te</span><span class="p">,</span> <span class="n">y_te</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">le_tag</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x_le</span><span class="p">,</span> <span class="n">y_le</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">pt_u</span> <span class="o">=</span> <span class="p">[</span><span class="n">te_tag</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">u_side</span><span class="p">]</span>
        <span class="n">pt_l</span> <span class="o">=</span> <span class="p">[</span><span class="n">le_tag</span><span class="p">]</span> <span class="o">+</span>\
               <span class="p">[</span><span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">l_side</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">te_tag</span><span class="p">]</span>

        <span class="c1"># airfoil boundary</span>
        <span class="n">spline_low</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_l</span><span class="p">[</span><span class="n">offset</span><span class="p">:],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">spline_le</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_u</span><span class="p">[</span><span class="o">-</span><span class="n">offset</span><span class="p">:]</span> <span class="o">+</span> <span class="n">pt_l</span><span class="p">[:</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">spline_up</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_u</span><span class="p">[:</span><span class="o">-</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

        <span class="c1"># domain and block construction points</span>
        <span class="n">pt_229</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x_te</span> <span class="o">-</span> <span class="n">b_width</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">229</span><span class="p">)</span>
        <span class="n">pt_230</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x_te</span> <span class="o">-</span> <span class="n">b_width</span><span class="p">,</span> <span class="o">-</span><span class="n">R</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">230</span><span class="p">)</span>
        <span class="n">pt_231</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x_te</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">231</span><span class="p">)</span>
        <span class="n">pt_232</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x_te</span><span class="p">,</span> <span class="o">-</span><span class="n">R</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">232</span><span class="p">)</span>
        <span class="n">pt_233</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">d_out</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">233</span><span class="p">)</span>
        <span class="n">pt_234</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">d_out</span><span class="p">,</span> <span class="o">-</span><span class="n">R</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">234</span><span class="p">)</span>
        <span class="n">pt_235</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">d_out</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">235</span><span class="p">)</span>

        <span class="c1"># domain and block lines</span>
        <span class="n">circle_4</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCircleArc</span><span class="p">(</span><span class="n">pt_230</span><span class="p">,</span> <span class="n">te_tag</span><span class="p">,</span> <span class="n">pt_229</span><span class="p">)</span>
        <span class="n">line_5</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_u</span><span class="p">[</span><span class="o">-</span><span class="n">offset</span><span class="p">],</span> <span class="n">pt_229</span><span class="p">)</span>
        <span class="n">line_6</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_l</span><span class="p">[</span><span class="n">offset</span><span class="p">],</span> <span class="n">pt_230</span><span class="p">)</span>
        <span class="n">line_7</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_229</span><span class="p">,</span> <span class="n">pt_231</span><span class="p">)</span>
        <span class="n">line_8</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_230</span><span class="p">,</span> <span class="n">pt_232</span><span class="p">)</span>
        <span class="n">line_9</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_231</span><span class="p">,</span> <span class="n">pt_233</span><span class="p">)</span>
        <span class="n">line_10</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_232</span><span class="p">,</span> <span class="n">pt_234</span><span class="p">)</span>
        <span class="n">line_11</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_235</span><span class="p">,</span> <span class="n">pt_234</span><span class="p">)</span>
        <span class="n">line_12</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_235</span><span class="p">,</span> <span class="n">pt_233</span><span class="p">)</span>
        <span class="n">line_13</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">te_tag</span><span class="p">,</span> <span class="n">pt_231</span><span class="p">)</span>
        <span class="n">line_14</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">te_tag</span><span class="p">,</span> <span class="n">pt_232</span><span class="p">)</span>
        <span class="n">line_15</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">te_tag</span><span class="p">,</span> <span class="n">pt_235</span><span class="p">)</span>

        <span class="c1"># meshing parameters</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">circle_4</span><span class="p">,</span> <span class="n">n_inlet</span><span class="p">,</span> <span class="s2">&quot;Bump&quot;</span><span class="p">,</span> <span class="n">r_inlet</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spline_le</span><span class="p">,</span> <span class="n">n_inlet</span><span class="p">,</span> <span class="s2">&quot;Bump&quot;</span><span class="p">,</span> <span class="n">r_inlet</span><span class="p">)</span>
        <span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">n_vertical</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="n">r_vertical</span><span class="p">)</span>
             <span class="k">for</span> <span class="n">lid</span> <span class="ow">in</span> <span class="p">[</span><span class="n">line_5</span><span class="p">,</span> <span class="n">line_6</span><span class="p">,</span> <span class="n">line_11</span><span class="p">,</span> <span class="n">line_12</span><span class="p">,</span> <span class="n">line_13</span><span class="p">,</span> <span class="n">line_14</span><span class="p">]]</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spline_low</span><span class="p">,</span> <span class="n">n_airfoil</span><span class="p">,</span> <span class="s2">&quot;Bump&quot;</span><span class="p">,</span> <span class="n">r_airfoil</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spline_up</span><span class="p">,</span> <span class="n">n_airfoil</span><span class="p">,</span> <span class="s2">&quot;Bump&quot;</span><span class="p">,</span> <span class="n">r_airfoil</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">line_7</span><span class="p">,</span> <span class="n">n_airfoil</span><span class="p">,</span> <span class="s2">&quot;Bump&quot;</span><span class="p">,</span> <span class="n">r_airfoil</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">line_8</span><span class="p">,</span> <span class="n">n_airfoil</span><span class="p">,</span> <span class="s2">&quot;Bump&quot;</span><span class="p">,</span> <span class="n">r_airfoil</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">line_15</span><span class="p">,</span> <span class="n">n_wake</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="n">r_wake</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">line_9</span><span class="p">,</span> <span class="n">n_wake</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="n">r_wake</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">line_10</span><span class="p">,</span> <span class="n">n_wake</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="n">r_wake</span><span class="p">)</span>

        <span class="c1"># domain and block surfaces</span>
        <span class="n">cloop_1</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">([</span><span class="n">circle_4</span><span class="p">,</span> <span class="o">-</span><span class="n">line_5</span><span class="p">,</span> <span class="n">spline_le</span><span class="p">,</span> <span class="n">line_6</span><span class="p">])</span>
        <span class="n">surf_1</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPlaneSurface</span><span class="p">([</span><span class="o">-</span><span class="n">cloop_1</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1001</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteSurface</span><span class="p">(</span><span class="n">surf_1</span><span class="p">)</span>

        <span class="n">cloop_2</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">([</span><span class="n">line_5</span><span class="p">,</span> <span class="n">line_7</span><span class="p">,</span> <span class="o">-</span><span class="n">line_13</span><span class="p">,</span> <span class="n">spline_up</span><span class="p">])</span>
        <span class="n">surf_2</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPlaneSurface</span><span class="p">([</span><span class="o">-</span><span class="n">cloop_2</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1002</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteSurface</span><span class="p">(</span><span class="n">surf_2</span><span class="p">)</span>

        <span class="n">cloop_3</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">([</span><span class="n">line_13</span><span class="p">,</span> <span class="n">line_9</span><span class="p">,</span> <span class="o">-</span><span class="n">line_12</span><span class="p">,</span> <span class="o">-</span><span class="n">line_15</span><span class="p">])</span>
        <span class="n">surf_3</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPlaneSurface</span><span class="p">([</span><span class="o">-</span><span class="n">cloop_3</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1003</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteSurface</span><span class="p">(</span><span class="n">surf_3</span><span class="p">)</span>

        <span class="n">cloop_4</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">([</span><span class="n">line_6</span><span class="p">,</span> <span class="n">line_8</span><span class="p">,</span> <span class="o">-</span><span class="n">line_14</span><span class="p">,</span> <span class="o">-</span><span class="n">spline_low</span><span class="p">])</span>
        <span class="n">surf_4</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPlaneSurface</span><span class="p">([</span><span class="o">-</span><span class="n">cloop_4</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1004</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteSurface</span><span class="p">(</span><span class="n">surf_4</span><span class="p">)</span>

        <span class="n">cloop_5</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">([</span><span class="n">line_14</span><span class="p">,</span> <span class="n">line_10</span><span class="p">,</span> <span class="o">-</span><span class="n">line_11</span><span class="p">,</span> <span class="o">-</span><span class="n">line_15</span><span class="p">])</span>
        <span class="n">surf_5</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPlaneSurface</span><span class="p">([</span><span class="o">-</span><span class="n">cloop_5</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1005</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteSurface</span><span class="p">(</span><span class="n">surf_5</span><span class="p">)</span>

        <span class="c1"># physical groups</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surf_tag</span> <span class="o">=</span> <span class="p">[</span><span class="n">surf_1</span><span class="p">,</span> <span class="n">surf_2</span><span class="p">,</span> <span class="n">surf_3</span><span class="p">,</span> <span class="o">-</span><span class="n">surf_5</span><span class="p">,</span> <span class="o">-</span><span class="n">surf_4</span><span class="p">]</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">surf_tag</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">circle_4</span><span class="p">,</span> <span class="n">line_7</span><span class="p">,</span> <span class="n">line_8</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BC: Inlet tags are </span><span class="si">{</span><span class="p">[</span><span class="n">circle_4</span><span class="p">,</span><span class="w"> </span><span class="n">line_7</span><span class="p">,</span><span class="w"> </span><span class="n">line_8</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">line_11</span><span class="p">,</span> <span class="n">line_12</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BC: Outlet tags are </span><span class="si">{</span><span class="p">[</span><span class="n">line_11</span><span class="p">,</span><span class="w"> </span><span class="n">line_12</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">line_9</span><span class="p">,</span> <span class="n">line_10</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BC: Side tags are </span><span class="si">{</span><span class="p">[</span><span class="n">line_9</span><span class="p">,</span><span class="w"> </span><span class="n">line_10</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">spline_up</span><span class="p">,</span> <span class="n">spline_le</span><span class="p">,</span> <span class="n">spline_low</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BC: Wall tags are </span><span class="si">{</span><span class="p">[</span><span class="n">spline_up</span><span class="p">,</span><span class="w"> </span><span class="n">spline_le</span><span class="p">,</span><span class="w"> </span><span class="n">spline_low</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="mesh.naca_block_mesh.NACABlockMesh.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">datfile</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Instantiates the BlockMesh object.</p>
<p><strong>Input</strong></p>
<ul>
<li>config (dict): the config file dictionary.</li>
<li>dat_file (str): path to input_geometry.dat.</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>aero_optim/mesh/naca_block_mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">datfile</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instantiates the BlockMesh object.</span>

<span class="sd">    **Input**</span>

<span class="sd">    - config (dict): the config file dictionary.</span>
<span class="sd">    - dat_file (str): path to input_geometry.dat.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">datfile</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesh.naca_block_mesh.NACABlockMesh.build_2dmesh" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_2dmesh</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p><strong>Builds</strong> the surface mesh of the computational domain.</p>
<p><strong>Inner</strong></p>
<ul>
<li>R (float): radius of the outer circle.</li>
<li>d_out (float): distance to the outlet.</li>
<li>offset (int): offset from leading edge.</li>
<li>b_width (float): block_width.</li>
<li>n_inlet (int): nbr of lead edge &amp; inlet nodes.</li>
<li>r_inlet (float): bump ratio of lead edge &amp; inlet nodes.</li>
<li>n_vertical (int) : nbr of out &amp; verti nodes.</li>
<li>r_vertical (float): out &amp; vert growth.</li>
<li>n_airfoil (int): nbr of nodes on each sides.</li>
<li>r_airfoil (float): airfoil sides growth.</li>
<li>n_wake (int): nbr of nodes in the wake dir.</li>
<li>r_wake (float): wake growth.</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>aero_optim/mesh/naca_block_mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build_2dmesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Builds** the surface mesh of the computational domain.</span>

<span class="sd">    **Inner**</span>

<span class="sd">    - R (float): radius of the outer circle.</span>
<span class="sd">    - d_out (float): distance to the outlet.</span>
<span class="sd">    - offset (int): offset from leading edge.</span>
<span class="sd">    - b_width (float): block_width.</span>
<span class="sd">    - n_inlet (int): nbr of lead edge &amp; inlet nodes.</span>
<span class="sd">    - r_inlet (float): bump ratio of lead edge &amp; inlet nodes.</span>
<span class="sd">    - n_vertical (int) : nbr of out &amp; verti nodes.</span>
<span class="sd">    - r_vertical (float): out &amp; vert growth.</span>
<span class="sd">    - n_airfoil (int): nbr of nodes on each sides.</span>
<span class="sd">    - r_airfoil (float): airfoil sides growth.</span>
<span class="sd">    - n_wake (int): nbr of nodes in the wake dir.</span>
<span class="sd">    - r_wake (float): wake growth.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dinlet</span>
    <span class="n">d_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doutlet</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;domain&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;le_offset&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">b_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;domain&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;block_width&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">n_inlet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;n_inlet&quot;</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
    <span class="n">r_inlet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;r_inlet&quot;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
    <span class="n">n_vertical</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;n_vertical&quot;</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
    <span class="n">r_vertical</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;r_vertical&quot;</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">0.95</span><span class="p">)</span>
    <span class="n">n_airfoil</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;n_airfoil&quot;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">r_airfoil</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;r_airfoil&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">n_wake</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;n_wake&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">r_wake</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;r_wake&quot;</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">0.95</span><span class="p">)</span>

    <span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_le</span> <span class="o">=</span> <span class="nb">min</span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">))</span>
    <span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_te</span> <span class="o">=</span> <span class="nb">max</span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">))</span>
    <span class="n">u_side</span><span class="p">,</span> <span class="n">l_side</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_naca</span><span class="p">()</span>

    <span class="c1"># add points and lines for the naca lower and upper parts</span>
    <span class="n">x_le</span><span class="p">,</span> <span class="n">y_le</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">idx_le</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">x_te</span><span class="p">,</span> <span class="n">y_te</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">idx_te</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">te_tag</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x_te</span><span class="p">,</span> <span class="n">y_te</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">le_tag</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x_le</span><span class="p">,</span> <span class="n">y_le</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">pt_u</span> <span class="o">=</span> <span class="p">[</span><span class="n">te_tag</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">u_side</span><span class="p">]</span>
    <span class="n">pt_l</span> <span class="o">=</span> <span class="p">[</span><span class="n">le_tag</span><span class="p">]</span> <span class="o">+</span>\
           <span class="p">[</span><span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">l_side</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">te_tag</span><span class="p">]</span>

    <span class="c1"># airfoil boundary</span>
    <span class="n">spline_low</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_l</span><span class="p">[</span><span class="n">offset</span><span class="p">:],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">spline_le</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_u</span><span class="p">[</span><span class="o">-</span><span class="n">offset</span><span class="p">:]</span> <span class="o">+</span> <span class="n">pt_l</span><span class="p">[:</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">spline_up</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_u</span><span class="p">[:</span><span class="o">-</span><span class="n">offset</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1"># domain and block construction points</span>
    <span class="n">pt_229</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x_te</span> <span class="o">-</span> <span class="n">b_width</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">229</span><span class="p">)</span>
    <span class="n">pt_230</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x_te</span> <span class="o">-</span> <span class="n">b_width</span><span class="p">,</span> <span class="o">-</span><span class="n">R</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">230</span><span class="p">)</span>
    <span class="n">pt_231</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x_te</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">231</span><span class="p">)</span>
    <span class="n">pt_232</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">x_te</span><span class="p">,</span> <span class="o">-</span><span class="n">R</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">232</span><span class="p">)</span>
    <span class="n">pt_233</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">d_out</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">233</span><span class="p">)</span>
    <span class="n">pt_234</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">d_out</span><span class="p">,</span> <span class="o">-</span><span class="n">R</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">234</span><span class="p">)</span>
    <span class="n">pt_235</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">d_out</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">235</span><span class="p">)</span>

    <span class="c1"># domain and block lines</span>
    <span class="n">circle_4</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCircleArc</span><span class="p">(</span><span class="n">pt_230</span><span class="p">,</span> <span class="n">te_tag</span><span class="p">,</span> <span class="n">pt_229</span><span class="p">)</span>
    <span class="n">line_5</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_u</span><span class="p">[</span><span class="o">-</span><span class="n">offset</span><span class="p">],</span> <span class="n">pt_229</span><span class="p">)</span>
    <span class="n">line_6</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_l</span><span class="p">[</span><span class="n">offset</span><span class="p">],</span> <span class="n">pt_230</span><span class="p">)</span>
    <span class="n">line_7</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_229</span><span class="p">,</span> <span class="n">pt_231</span><span class="p">)</span>
    <span class="n">line_8</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_230</span><span class="p">,</span> <span class="n">pt_232</span><span class="p">)</span>
    <span class="n">line_9</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_231</span><span class="p">,</span> <span class="n">pt_233</span><span class="p">)</span>
    <span class="n">line_10</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_232</span><span class="p">,</span> <span class="n">pt_234</span><span class="p">)</span>
    <span class="n">line_11</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_235</span><span class="p">,</span> <span class="n">pt_234</span><span class="p">)</span>
    <span class="n">line_12</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_235</span><span class="p">,</span> <span class="n">pt_233</span><span class="p">)</span>
    <span class="n">line_13</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">te_tag</span><span class="p">,</span> <span class="n">pt_231</span><span class="p">)</span>
    <span class="n">line_14</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">te_tag</span><span class="p">,</span> <span class="n">pt_232</span><span class="p">)</span>
    <span class="n">line_15</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">te_tag</span><span class="p">,</span> <span class="n">pt_235</span><span class="p">)</span>

    <span class="c1"># meshing parameters</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">circle_4</span><span class="p">,</span> <span class="n">n_inlet</span><span class="p">,</span> <span class="s2">&quot;Bump&quot;</span><span class="p">,</span> <span class="n">r_inlet</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spline_le</span><span class="p">,</span> <span class="n">n_inlet</span><span class="p">,</span> <span class="s2">&quot;Bump&quot;</span><span class="p">,</span> <span class="n">r_inlet</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">n_vertical</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="n">r_vertical</span><span class="p">)</span>
         <span class="k">for</span> <span class="n">lid</span> <span class="ow">in</span> <span class="p">[</span><span class="n">line_5</span><span class="p">,</span> <span class="n">line_6</span><span class="p">,</span> <span class="n">line_11</span><span class="p">,</span> <span class="n">line_12</span><span class="p">,</span> <span class="n">line_13</span><span class="p">,</span> <span class="n">line_14</span><span class="p">]]</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spline_low</span><span class="p">,</span> <span class="n">n_airfoil</span><span class="p">,</span> <span class="s2">&quot;Bump&quot;</span><span class="p">,</span> <span class="n">r_airfoil</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spline_up</span><span class="p">,</span> <span class="n">n_airfoil</span><span class="p">,</span> <span class="s2">&quot;Bump&quot;</span><span class="p">,</span> <span class="n">r_airfoil</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">line_7</span><span class="p">,</span> <span class="n">n_airfoil</span><span class="p">,</span> <span class="s2">&quot;Bump&quot;</span><span class="p">,</span> <span class="n">r_airfoil</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">line_8</span><span class="p">,</span> <span class="n">n_airfoil</span><span class="p">,</span> <span class="s2">&quot;Bump&quot;</span><span class="p">,</span> <span class="n">r_airfoil</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">line_15</span><span class="p">,</span> <span class="n">n_wake</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="n">r_wake</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">line_9</span><span class="p">,</span> <span class="n">n_wake</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="n">r_wake</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">line_10</span><span class="p">,</span> <span class="n">n_wake</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="n">r_wake</span><span class="p">)</span>

    <span class="c1"># domain and block surfaces</span>
    <span class="n">cloop_1</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">([</span><span class="n">circle_4</span><span class="p">,</span> <span class="o">-</span><span class="n">line_5</span><span class="p">,</span> <span class="n">spline_le</span><span class="p">,</span> <span class="n">line_6</span><span class="p">])</span>
    <span class="n">surf_1</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPlaneSurface</span><span class="p">([</span><span class="o">-</span><span class="n">cloop_1</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1001</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteSurface</span><span class="p">(</span><span class="n">surf_1</span><span class="p">)</span>

    <span class="n">cloop_2</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">([</span><span class="n">line_5</span><span class="p">,</span> <span class="n">line_7</span><span class="p">,</span> <span class="o">-</span><span class="n">line_13</span><span class="p">,</span> <span class="n">spline_up</span><span class="p">])</span>
    <span class="n">surf_2</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPlaneSurface</span><span class="p">([</span><span class="o">-</span><span class="n">cloop_2</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1002</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteSurface</span><span class="p">(</span><span class="n">surf_2</span><span class="p">)</span>

    <span class="n">cloop_3</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">([</span><span class="n">line_13</span><span class="p">,</span> <span class="n">line_9</span><span class="p">,</span> <span class="o">-</span><span class="n">line_12</span><span class="p">,</span> <span class="o">-</span><span class="n">line_15</span><span class="p">])</span>
    <span class="n">surf_3</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPlaneSurface</span><span class="p">([</span><span class="o">-</span><span class="n">cloop_3</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1003</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteSurface</span><span class="p">(</span><span class="n">surf_3</span><span class="p">)</span>

    <span class="n">cloop_4</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">([</span><span class="n">line_6</span><span class="p">,</span> <span class="n">line_8</span><span class="p">,</span> <span class="o">-</span><span class="n">line_14</span><span class="p">,</span> <span class="o">-</span><span class="n">spline_low</span><span class="p">])</span>
    <span class="n">surf_4</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPlaneSurface</span><span class="p">([</span><span class="o">-</span><span class="n">cloop_4</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1004</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteSurface</span><span class="p">(</span><span class="n">surf_4</span><span class="p">)</span>

    <span class="n">cloop_5</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">([</span><span class="n">line_14</span><span class="p">,</span> <span class="n">line_10</span><span class="p">,</span> <span class="o">-</span><span class="n">line_11</span><span class="p">,</span> <span class="o">-</span><span class="n">line_15</span><span class="p">])</span>
    <span class="n">surf_5</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPlaneSurface</span><span class="p">([</span><span class="o">-</span><span class="n">cloop_5</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1005</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteSurface</span><span class="p">(</span><span class="n">surf_5</span><span class="p">)</span>

    <span class="c1"># physical groups</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">surf_tag</span> <span class="o">=</span> <span class="p">[</span><span class="n">surf_1</span><span class="p">,</span> <span class="n">surf_2</span><span class="p">,</span> <span class="n">surf_3</span><span class="p">,</span> <span class="o">-</span><span class="n">surf_5</span><span class="p">,</span> <span class="o">-</span><span class="n">surf_4</span><span class="p">]</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">surf_tag</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">circle_4</span><span class="p">,</span> <span class="n">line_7</span><span class="p">,</span> <span class="n">line_8</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BC: Inlet tags are </span><span class="si">{</span><span class="p">[</span><span class="n">circle_4</span><span class="p">,</span><span class="w"> </span><span class="n">line_7</span><span class="p">,</span><span class="w"> </span><span class="n">line_8</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">line_11</span><span class="p">,</span> <span class="n">line_12</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BC: Outlet tags are </span><span class="si">{</span><span class="p">[</span><span class="n">line_11</span><span class="p">,</span><span class="w"> </span><span class="n">line_12</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">line_9</span><span class="p">,</span> <span class="n">line_10</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BC: Side tags are </span><span class="si">{</span><span class="p">[</span><span class="n">line_9</span><span class="p">,</span><span class="w"> </span><span class="n">line_10</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">spline_up</span><span class="p">,</span> <span class="n">spline_le</span><span class="p">,</span> <span class="n">spline_low</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BC: Wall tags are </span><span class="si">{</span><span class="p">[</span><span class="n">spline_up</span><span class="p">,</span><span class="w"> </span><span class="n">spline_le</span><span class="p">,</span><span class="w"> </span><span class="n">spline_low</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><hr style="border:1px solid grey">



<div class="doc doc-object doc-class">



<h3 id="mesh.cascade_mesh.CascadeMesh" class="doc doc-heading">
            <code>mesh.cascade_mesh.CascadeMesh</code>


</h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="aero_optim.mesh.mesh.Mesh">Mesh</span></code></p>


        <p>This class implements a mesh routine for a compressor cascade geometry.</p>







              <details class="quote">
                <summary>Source code in <code>aero_optim/mesh/cascade_mesh.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CascadeMesh</span><span class="p">(</span><span class="n">Mesh</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class implements a mesh routine for a compressor cascade geometry.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">datfile</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instantiates the CascadeMesh object.</span>

<span class="sd">        **Input**</span>

<span class="sd">        - config (dict): the config file dictionary.</span>
<span class="sd">        - dat_file (str): path to input_geometry.dat.</span>

<span class="sd">        **Inner**</span>

<span class="sd">        - doutlet (float): outlet distance to the blade trailing edge.</span>
<span class="sd">        - dlr_mesh (bool): builds the DLR provided mesh (True) or a simpler for adaptation (False).</span>
<span class="sd">        - bl_sizefar (float): boundary layer mesh size far from the curves.</span>
<span class="sd">        - nodes_inlet (int): the number of nodes to mesh the inlet.</span>
<span class="sd">        - nodes_outlet (int): the number of nodes to mesh the outlet.</span>
<span class="sd">        - snodes_inlet (int): the number of nodes to mesh the inlet top and bottom sides.</span>
<span class="sd">        - snodes_outlet (int): the number of nodes to mesh the outlet top and bottom sides.</span>
<span class="sd">        - c_snodes (int): the number of nodes to mesh the inner sides.</span>
<span class="sd">        - le (int): the number of nodes to mesh the blade leading edge portion.</span>
<span class="sd">        - te (int): the number of nodes to mesh the blade trailing edge lower portion.</span>
<span class="sd">        - nodes_sp2 (int): the number of nodes to mesh the 1st section of the blade suction side.</span>
<span class="sd">        - nodes_sp3 (int): the number of nodes to mesh the 2nd section of the blade suction side.</span>
<span class="sd">        - nodes_sp4 (int): the number of nodes to mesh the 3rd section of the blade suction side.</span>
<span class="sd">        - nodes_sp7 (int): the number of nodes to mesh the 1st section of the blade pressure side.</span>
<span class="sd">        - nodes_sp8 (int): the number of nodes to mesh the 2nd section of the blade pressure side.</span>
<span class="sd">        - nodes_ss (int): the number of nodes to mesh the suction side (dlr_mesh set to False).</span>
<span class="sd">        - nodes_ps (int): the number of nodes to mesh the pressure side (dlr_mesh set to False).</span>
<span class="sd">        - cyl_vin (float): cylinder field parameter Vin.</span>
<span class="sd">        - cyl_vout (float): cylinder field parameter Vout.</span>
<span class="sd">        - cyl_xaxis (float): cylinder field parameter Xaxis.</span>
<span class="sd">        - cyl_xcenter (float): cylinder field parameter Xcenter.</span>

<span class="sd">        Note:</span>
<span class="sd">            for the DLR configuration, the blade is split into 9 splines (clockwise from the tip):</span>

<span class="sd">            * 2 splines (1 and 9) for the leading edge parameterized with **le**</span>
<span class="sd">              i.e. each spline has **le**/2 nodes,</span>
<span class="sd">            * 2 splines (5 and 6) for the trailing edge parameterized with **te**</span>
<span class="sd">              i.e. each spline has **te**/2 nodes,</span>
<span class="sd">            * 3 splines for the suction side (2, 3, 4) of lengths 0.027, 0.038 and 0.061 m,</span>
<span class="sd">              and parameterized with **nodes_sp2**, **nodes_sp3** and **nodes_sp4**,</span>
<span class="sd">            * 2 splines for the pressure side (7, 8) of lengths 0.0526 and 0.0167 m,</span>
<span class="sd">              and parameterized with **nodes_sp7**, **nodes_sp8**</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">datfile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doutlet</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;domain&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;outlet&quot;</span><span class="p">,</span> <span class="mf">6.3e-2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlr_mesh</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;DLR_mesh&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bl_sizefar</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;bl_sizefar&quot;</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_inlet</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodes_inlet&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_outlet</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodes_outlet&quot;</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">snodes_inlet</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;side_nodes_inlet&quot;</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">snodes_outlet</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;side_nodes_outlet&quot;</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c_snodes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;curved_side_nodes&quot;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">le</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;le&quot;</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">te</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;te&quot;</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sp2</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodes_sp2&quot;</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sp3</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodes_sp3&quot;</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sp4</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodes_sp4&quot;</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sp7</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodes_sp7&quot;</span><span class="p">,</span> <span class="mi">57</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sp8</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodes_sp8&quot;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_ss</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodes_ss&quot;</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_ps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodes_ps&quot;</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cyl_vin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cyl_vin&quot;</span><span class="p">,</span> <span class="mf">8e-4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cyl_vout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cyl_vout&quot;</span><span class="p">,</span> <span class="mf">5e-3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cyl_xaxis</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cyl_xaxis&quot;</span><span class="p">,</span> <span class="mf">1.675e-2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cyl_xcenter</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cyl_xcenter&quot;</span><span class="p">,</span> <span class="mf">8.364e-2</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;processing config..&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;domain&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">]:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;no &lt;domain&gt; entry in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;gmsh&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, empty entry added&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;domain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reorder_blade</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Returns** the blade profile after reordering.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">([</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">])</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="n">start</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">return</span> <span class="p">[[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="n">start</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[:</span><span class="n">start</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[:</span><span class="n">start</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="n">start</span><span class="p">:]]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build_bl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">blade_tag</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Builds** the boundary layer around the blade.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f_bl</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;BoundaryLayer&#39;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumbers</span><span class="p">(</span><span class="n">f_bl</span><span class="p">,</span> <span class="s1">&#39;CurvesList&#39;</span><span class="p">,</span> <span class="n">blade_tag</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_bl</span><span class="p">,</span> <span class="s1">&#39;Size&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl_size</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_bl</span><span class="p">,</span> <span class="s1">&#39;Ratio&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl_ratio</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_bl</span><span class="p">,</span> <span class="s1">&#39;Quads&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structured</span><span class="p">))</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_bl</span><span class="p">,</span> <span class="s1">&#39;Thickness&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl_thickness</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_bl</span><span class="p">,</span> <span class="s1">&#39;SizeFar&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl_sizefar</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setAsBoundaryLayer</span><span class="p">(</span><span class="n">f_bl</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build_cylinder_field</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">VIn</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">VOut</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
            <span class="n">XAxis</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">XCenter</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
            <span class="n">YAxis</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">YCenter</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
            <span class="n">ZAxis</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Builds** a cylinder field in the computational domain.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f_cyl</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;Cylinder&#39;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_cyl</span><span class="p">,</span> <span class="s1">&#39;Radius&#39;</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_cyl</span><span class="p">,</span> <span class="s1">&#39;VIn&#39;</span><span class="p">,</span> <span class="n">VIn</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_cyl</span><span class="p">,</span> <span class="s1">&#39;VOut&#39;</span><span class="p">,</span> <span class="n">VOut</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_cyl</span><span class="p">,</span> <span class="s1">&#39;XAxis&#39;</span><span class="p">,</span> <span class="n">XAxis</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_cyl</span><span class="p">,</span> <span class="s1">&#39;XCenter&#39;</span><span class="p">,</span> <span class="n">XCenter</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_cyl</span><span class="p">,</span> <span class="s1">&#39;YAxis&#39;</span><span class="p">,</span> <span class="n">YAxis</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_cyl</span><span class="p">,</span> <span class="s1">&#39;YCenter&#39;</span><span class="p">,</span> <span class="n">YCenter</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_cyl</span><span class="p">,</span> <span class="s1">&#39;ZAxis&#39;</span><span class="p">,</span> <span class="n">ZAxis</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setAsBackgroundMesh</span><span class="p">(</span><span class="n">f_cyl</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f_cyl</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build_minaniso_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Builds** a MinAniso field in the computational domain.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f_minaniso</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;MinAniso&#39;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumbers</span><span class="p">(</span><span class="n">f_minaniso</span><span class="p">,</span> <span class="s1">&#39;FieldsList&#39;</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setAsBackgroundMesh</span><span class="p">(</span><span class="n">f_minaniso</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build_2dmesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Builds** the surface mesh of the computational domain.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">wall</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reorder_blade</span><span class="p">()</span>
        <span class="n">pt_wall</span> <span class="o">=</span> <span class="p">[</span><span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">wall</span><span class="p">]</span>

        <span class="c1"># blade splines and transfinite curves</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlr_mesh</span><span class="p">:</span>
            <span class="n">spl_1</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_wall</span><span class="p">[:</span><span class="mi">35</span><span class="p">])</span>
            <span class="n">spl_2</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">35</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">88</span><span class="p">])</span>
            <span class="n">spl_3</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">88</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">129</span><span class="p">])</span>
            <span class="n">spl_4</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">129</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">157</span><span class="p">])</span>
            <span class="n">spl_5</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">157</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">168</span><span class="p">])</span>
            <span class="n">spl_6</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">168</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">179</span><span class="p">])</span>
            <span class="n">spl_7</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">179</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">245</span><span class="p">])</span>
            <span class="n">spl_8</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">245</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">287</span><span class="p">])</span>
            <span class="n">spl_9</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">287</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">322</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">le</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.02</span><span class="p">)</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sp2</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.03</span><span class="p">)</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sp3</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sp4</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">0.94</span><span class="p">)</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">te</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">0.97</span><span class="p">)</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_6</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">te</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.025</span><span class="p">)</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_7</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sp7</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.015</span><span class="p">)</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_8</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sp8</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">0.955</span><span class="p">)</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_9</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">le</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">)</span>
            <span class="n">spl_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">spl_1</span><span class="p">,</span> <span class="n">spl_2</span><span class="p">,</span> <span class="n">spl_3</span><span class="p">,</span> <span class="n">spl_4</span><span class="p">,</span> <span class="n">spl_5</span><span class="p">,</span> <span class="n">spl_6</span><span class="p">,</span> <span class="n">spl_7</span><span class="p">,</span> <span class="n">spl_8</span><span class="p">,</span> <span class="n">spl_9</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">spl_le</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">287</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">322</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">pt_wall</span><span class="p">[:</span><span class="mi">35</span><span class="p">])</span>
            <span class="n">spl_ss</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span>
                <span class="n">pt_wall</span><span class="p">[</span><span class="mi">35</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">88</span><span class="p">]</span> <span class="o">+</span> <span class="n">pt_wall</span><span class="p">[</span><span class="mi">88</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">129</span><span class="p">]</span> <span class="o">+</span> <span class="n">pt_wall</span><span class="p">[</span><span class="mi">129</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">157</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">spl_te</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">157</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">168</span><span class="p">]</span> <span class="o">+</span> <span class="n">pt_wall</span><span class="p">[</span><span class="mi">168</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">179</span><span class="p">])</span>
            <span class="n">spl_ps</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">179</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">245</span><span class="p">]</span> <span class="o">+</span> <span class="n">pt_wall</span><span class="p">[</span><span class="mi">245</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">287</span><span class="p">])</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_le</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">le</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_ss</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_ss</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_te</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">te</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_ps</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_ps</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
            <span class="n">spl_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">spl_le</span><span class="p">,</span> <span class="n">spl_ss</span><span class="p">,</span> <span class="n">spl_te</span><span class="p">,</span> <span class="n">spl_ps</span><span class="p">]</span>
        <span class="n">blade_loop</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">(</span><span class="n">spl_list</span><span class="p">)</span>

        <span class="c1"># domain construction points</span>
        <span class="n">pt_323</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="o">-</span><span class="mf">6e-2</span><span class="p">,</span> <span class="o">-</span><span class="mf">5e-2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">pt_324</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5e-2</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5e-2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">pt_325</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.7e-2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">pt_326</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">1.270973e-02</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.164466e-02</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">pt_327</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">2.585445e-02</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.360298e-03</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">pt_328</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">3.934429e-02</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.053609e-03</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">pt_329</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">5.308943e-02</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.631280e-03</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">pt_330</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">6.7e-2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">pt_331</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">6.7e-2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">doutlet</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">pt_332</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">6.7e-2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">doutlet</span><span class="p">,</span> <span class="mf">4.039e-2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">pt_333</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">6.7e-2</span><span class="p">,</span> <span class="mf">4.039e-2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">pt_334</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">5.308943e-02</span><span class="p">,</span> <span class="mf">3.875872e-02</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">pt_335</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">3.934429e-02</span><span class="p">,</span> <span class="mf">3.633639e-02</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">pt_336</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">2.585445e-02</span><span class="p">,</span> <span class="mf">3.302970e-02</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">pt_337</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">1.270973e-02</span><span class="p">,</span> <span class="mf">2.874534e-02</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">pt_338</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">2.339e-2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">pt_339</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5e-2</span><span class="p">,</span> <span class="mf">1.539e-2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">pt_340</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="o">-</span><span class="mf">6e-2</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.61e-3</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>

        <span class="c1"># domain construction lines</span>
        <span class="n">l_10</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_340</span><span class="p">,</span> <span class="n">pt_323</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">l_11</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_323</span><span class="p">,</span> <span class="n">pt_324</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
        <span class="n">l_12</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_339</span><span class="p">,</span> <span class="n">pt_340</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlr_mesh</span><span class="p">:</span>
            <span class="n">l_13</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_324</span><span class="p">,</span> <span class="n">pt_339</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
        <span class="n">l_14</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_324</span><span class="p">,</span> <span class="n">pt_325</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">l_15</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_325</span><span class="p">,</span> <span class="n">pt_326</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">l_16</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_326</span><span class="p">,</span> <span class="n">pt_327</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">l_17</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_327</span><span class="p">,</span> <span class="n">pt_328</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
        <span class="n">l_18</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_328</span><span class="p">,</span> <span class="n">pt_329</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
        <span class="n">l_19</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_329</span><span class="p">,</span> <span class="n">pt_330</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span>
        <span class="n">l_20</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_330</span><span class="p">,</span> <span class="n">pt_331</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">l_21</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_331</span><span class="p">,</span> <span class="n">pt_332</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
        <span class="n">l_22</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_332</span><span class="p">,</span> <span class="n">pt_333</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
        <span class="n">l_23</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_333</span><span class="p">,</span> <span class="n">pt_334</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
        <span class="n">l_24</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_334</span><span class="p">,</span> <span class="n">pt_335</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
        <span class="n">l_25</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_335</span><span class="p">,</span> <span class="n">pt_336</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
        <span class="n">l_26</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_336</span><span class="p">,</span> <span class="n">pt_337</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
        <span class="n">l_27</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_337</span><span class="p">,</span> <span class="n">pt_338</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span>
        <span class="n">l_28</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_338</span><span class="p">,</span> <span class="n">pt_339</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>

        <span class="c1"># transfinite curves on non-blade boundaries</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">l_10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_inlet</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlr_mesh</span><span class="p">:</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">l_13</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_inlet</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">l_21</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_outlet</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
        <span class="c1"># bottom / top periodicity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span> <span class="o">=</span> <span class="p">[</span><span class="n">l_11</span><span class="p">,</span> <span class="n">l_14</span><span class="p">,</span> <span class="n">l_15</span><span class="p">,</span> <span class="n">l_16</span><span class="p">,</span> <span class="n">l_17</span><span class="p">,</span> <span class="n">l_18</span><span class="p">,</span> <span class="n">l_19</span><span class="p">,</span> <span class="n">l_20</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span> <span class="o">=</span> <span class="p">[</span><span class="n">l_12</span><span class="p">,</span> <span class="n">l_28</span><span class="p">,</span> <span class="n">l_27</span><span class="p">,</span> <span class="n">l_26</span><span class="p">,</span> <span class="n">l_25</span><span class="p">,</span> <span class="n">l_24</span><span class="p">,</span> <span class="n">l_23</span><span class="p">,</span> <span class="n">l_22</span><span class="p">]</span>
        <span class="c1"># bottom non-curved side nodes</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">l_11</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">snodes_inlet</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">l_20</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">snodes_outlet</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
        <span class="c1"># bottom curved side nodes</span>
        <span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">l_i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_snodes</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
             <span class="k">for</span> <span class="n">l_i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="c1"># periodic boundaries /y direction</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
        <span class="n">translation</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.04039</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">tid</span><span class="p">,</span> <span class="n">bid</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span><span class="p">):</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setPeriodic</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">tid</span><span class="p">],</span> <span class="p">[</span><span class="n">bid</span><span class="p">],</span> <span class="n">translation</span><span class="p">)</span>

        <span class="c1"># closed curve loop and computational domain surface definition</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlr_mesh</span><span class="p">:</span>
            <span class="n">cloop_2</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">([</span><span class="n">l_10</span><span class="p">,</span> <span class="n">l_11</span><span class="p">,</span> <span class="n">l_12</span><span class="p">,</span> <span class="n">l_13</span><span class="p">])</span>
            <span class="n">cloop_3</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">(</span>
                <span class="p">[</span><span class="o">-</span><span class="n">l_13</span><span class="p">,</span> <span class="n">l_14</span><span class="p">,</span> <span class="n">l_15</span><span class="p">,</span> <span class="n">l_16</span><span class="p">,</span> <span class="n">l_17</span><span class="p">,</span> <span class="n">l_18</span><span class="p">,</span> <span class="n">l_19</span><span class="p">,</span> <span class="n">l_20</span><span class="p">,</span>
                 <span class="n">l_21</span><span class="p">,</span> <span class="n">l_22</span><span class="p">,</span> <span class="n">l_23</span><span class="p">,</span> <span class="n">l_24</span><span class="p">,</span> <span class="n">l_25</span><span class="p">,</span> <span class="n">l_26</span><span class="p">,</span> <span class="n">l_27</span><span class="p">,</span> <span class="n">l_28</span><span class="p">,]</span>
            <span class="p">)</span>
            <span class="n">surf_1</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPlaneSurface</span><span class="p">([</span><span class="n">cloop_2</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1002</span><span class="p">)</span>
            <span class="n">surf_2</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPlaneSurface</span><span class="p">([</span><span class="n">cloop_3</span><span class="p">,</span> <span class="n">blade_loop</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1003</span><span class="p">)</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteSurface</span><span class="p">(</span><span class="n">surf_1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cloop_3</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">(</span>
                <span class="p">[</span><span class="n">l_10</span><span class="p">,</span> <span class="n">l_11</span><span class="p">,</span> <span class="n">l_14</span><span class="p">,</span> <span class="n">l_15</span><span class="p">,</span> <span class="n">l_16</span><span class="p">,</span> <span class="n">l_17</span><span class="p">,</span> <span class="n">l_18</span><span class="p">,</span> <span class="n">l_19</span><span class="p">,</span> <span class="n">l_20</span><span class="p">,</span>
                 <span class="n">l_21</span><span class="p">,</span> <span class="n">l_22</span><span class="p">,</span> <span class="n">l_23</span><span class="p">,</span> <span class="n">l_24</span><span class="p">,</span> <span class="n">l_25</span><span class="p">,</span> <span class="n">l_26</span><span class="p">,</span> <span class="n">l_27</span><span class="p">,</span> <span class="n">l_28</span><span class="p">,</span> <span class="n">l_12</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">surf_2</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPlaneSurface</span><span class="p">([</span><span class="n">cloop_3</span><span class="p">,</span> <span class="n">blade_loop</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1003</span><span class="p">)</span>

        <span class="c1"># Fields definition</span>
        <span class="c1"># Boundary Layer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build_bl</span><span class="p">(</span><span class="n">spl_list</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="c1"># Cylinder #1</span>
        <span class="n">f_cyl1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_cylinder_field</span><span class="p">(</span>
            <span class="mf">9e-3</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cyl_vin</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cyl_vout</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cyl_xaxis</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cyl_xcenter</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">1.171e-3</span><span class="p">,</span>
            <span class="mf">1.9754e-2</span>
        <span class="p">)</span>
        <span class="c1"># Cylinder #2</span>
        <span class="n">f_cyl2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_cylinder_field</span><span class="p">(</span>
            <span class="mf">1.62e-2</span><span class="p">,</span> <span class="mf">1.6e-3</span><span class="p">,</span> <span class="mf">5e-3</span><span class="p">,</span> <span class="mf">2.01e-2</span><span class="p">,</span> <span class="mf">8.699e-2</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.406e-3</span><span class="p">,</span> <span class="mf">1.9519e-2</span>
        <span class="p">)</span>
        <span class="c1"># MinAniso</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build_minaniso_field</span><span class="p">([</span><span class="n">f_cyl1</span><span class="p">,</span> <span class="n">f_cyl2</span><span class="p">])</span>

        <span class="c1"># define physical groups for boundary conditions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surf_tag</span> <span class="o">=</span> <span class="p">[</span><span class="n">surf_1</span><span class="p">,</span> <span class="n">surf_2</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlr_mesh</span> <span class="k">else</span> <span class="p">[</span><span class="n">surf_2</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extrusion_layers</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">surf_tag</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;fluid&quot;</span><span class="p">)</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">l_10</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;inlet&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2D BC: Inlet tags are </span><span class="si">{</span><span class="p">[</span><span class="n">l_10</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">l_21</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;outlet&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2D BC: Outlet tags are </span><span class="si">{</span><span class="p">[</span><span class="n">l_21</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">spl_list</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;wall&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2D BC: Wall tags are </span><span class="si">{</span><span class="n">spl_list</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;periodic_vert_l&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2D BC: Top tags are </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;periodic_vert_r&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2D BC: Bottom tags are </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">surf_tag</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;periodic_span_l&quot;</span><span class="p">)</span>

        <span class="c1"># non-corner points defined as flow-field, inner block line and wall nodes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">non_corner_tags</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">s_tag</span><span class="p">)</span> <span class="k">for</span> <span class="n">s_tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">surf_tag</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">non_corner_tags</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">s_tag</span><span class="p">)</span> <span class="k">for</span> <span class="n">s_tag</span> <span class="ow">in</span> <span class="n">spl_list</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlr_mesh</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">non_corner_tags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">l_13</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build_3dmesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Performs** an extrusion along the z axis.</span>
<span class="sd">        - h_size (float): the total extruded depth.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">h_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extrusion_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ext_tag</span> <span class="o">=</span> <span class="p">[</span><span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">extrude</span><span class="p">(</span>
            <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">)],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">h_size</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">extrusion_layers</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">surf_tag</span><span class="p">]</span>
        <span class="c1"># retrieve extruded surfaces and volumes</span>
        <span class="n">vol</span> <span class="o">=</span> <span class="p">[</span><span class="n">tu</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">tu</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ext_tag</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext_tag</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]]]</span>
        <span class="n">top</span> <span class="o">=</span> <span class="p">[</span><span class="n">tu</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">tu</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ext_tag</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext_tag</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]]]</span>
        <span class="c1"># 1st block</span>
        <span class="n">inlet</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ext_tag</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">perlo</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ext_tag</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">perup</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ext_tag</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="c1"># 2nd block</span>
        <span class="n">perlo</span> <span class="o">+=</span> <span class="p">[</span><span class="n">tu</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">tu</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext_tag</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">:</span><span class="mi">10</span><span class="p">]]</span>
        <span class="n">outlet</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ext_tag</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">10</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">perup</span> <span class="o">+=</span> <span class="p">[</span><span class="n">tu</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">tu</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext_tag</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">11</span><span class="p">:</span><span class="mi">18</span><span class="p">]]</span>
        <span class="n">wall</span> <span class="o">=</span> <span class="p">[</span><span class="n">tu</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">tu</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext_tag</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">18</span><span class="p">:]]</span>
        <span class="c1"># create physical groups</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">vol</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;fluid&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;3D BC: vol tag is 2000&quot;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">2001</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;periodic_span_r&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;3D BC: periodic_span_l tag is 100&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;3D BC: periodic_span_r tag is 2001&quot;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">perlo</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">2003</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;periodic_vert_l&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;3D BC: periodic_vert_l tag is 2003&quot;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">perup</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">2004</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;periodic_vert_r&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;3D BC: periodic_vert_r tag is 2004&quot;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">inlet</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">2005</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;inlet&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;3D BC: inlet tag is 2005&quot;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">outlet</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">2006</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;outlet&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;3D BC: outlet tag is 2006&quot;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">wall</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">2007</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;wall&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;3D BC: wall tag is 2007&quot;</span><span class="p">)</span>
        <span class="c1"># set 2 tags to none to prevent reformatting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">non_corner_tags</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="mesh.cascade_mesh.CascadeMesh.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">datfile</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Instantiates the CascadeMesh object.</p>
<p><strong>Input</strong></p>
<ul>
<li>config (dict): the config file dictionary.</li>
<li>dat_file (str): path to input_geometry.dat.</li>
</ul>
<p><strong>Inner</strong></p>
<ul>
<li>doutlet (float): outlet distance to the blade trailing edge.</li>
<li>dlr_mesh (bool): builds the DLR provided mesh (True) or a simpler for adaptation (False).</li>
<li>bl_sizefar (float): boundary layer mesh size far from the curves.</li>
<li>nodes_inlet (int): the number of nodes to mesh the inlet.</li>
<li>nodes_outlet (int): the number of nodes to mesh the outlet.</li>
<li>snodes_inlet (int): the number of nodes to mesh the inlet top and bottom sides.</li>
<li>snodes_outlet (int): the number of nodes to mesh the outlet top and bottom sides.</li>
<li>c_snodes (int): the number of nodes to mesh the inner sides.</li>
<li>le (int): the number of nodes to mesh the blade leading edge portion.</li>
<li>te (int): the number of nodes to mesh the blade trailing edge lower portion.</li>
<li>nodes_sp2 (int): the number of nodes to mesh the 1st section of the blade suction side.</li>
<li>nodes_sp3 (int): the number of nodes to mesh the 2nd section of the blade suction side.</li>
<li>nodes_sp4 (int): the number of nodes to mesh the 3rd section of the blade suction side.</li>
<li>nodes_sp7 (int): the number of nodes to mesh the 1st section of the blade pressure side.</li>
<li>nodes_sp8 (int): the number of nodes to mesh the 2nd section of the blade pressure side.</li>
<li>nodes_ss (int): the number of nodes to mesh the suction side (dlr_mesh set to False).</li>
<li>nodes_ps (int): the number of nodes to mesh the pressure side (dlr_mesh set to False).</li>
<li>cyl_vin (float): cylinder field parameter Vin.</li>
<li>cyl_vout (float): cylinder field parameter Vout.</li>
<li>cyl_xaxis (float): cylinder field parameter Xaxis.</li>
<li>cyl_xcenter (float): cylinder field parameter Xcenter.</li>
</ul>


<details class="note" open>
  <summary>Note</summary>
  <p>for the DLR configuration, the blade is split into 9 splines (clockwise from the tip):</p>
<ul>
<li>2 splines (1 and 9) for the leading edge parameterized with <strong>le</strong>
  i.e. each spline has <strong>le</strong>/2 nodes,</li>
<li>2 splines (5 and 6) for the trailing edge parameterized with <strong>te</strong>
  i.e. each spline has <strong>te</strong>/2 nodes,</li>
<li>3 splines for the suction side (2, 3, 4) of lengths 0.027, 0.038 and 0.061 m,
  and parameterized with <strong>nodes_sp2</strong>, <strong>nodes_sp3</strong> and <strong>nodes_sp4</strong>,</li>
<li>2 splines for the pressure side (7, 8) of lengths 0.0526 and 0.0167 m,
  and parameterized with <strong>nodes_sp7</strong>, <strong>nodes_sp8</strong></li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>aero_optim/mesh/cascade_mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">datfile</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instantiates the CascadeMesh object.</span>

<span class="sd">    **Input**</span>

<span class="sd">    - config (dict): the config file dictionary.</span>
<span class="sd">    - dat_file (str): path to input_geometry.dat.</span>

<span class="sd">    **Inner**</span>

<span class="sd">    - doutlet (float): outlet distance to the blade trailing edge.</span>
<span class="sd">    - dlr_mesh (bool): builds the DLR provided mesh (True) or a simpler for adaptation (False).</span>
<span class="sd">    - bl_sizefar (float): boundary layer mesh size far from the curves.</span>
<span class="sd">    - nodes_inlet (int): the number of nodes to mesh the inlet.</span>
<span class="sd">    - nodes_outlet (int): the number of nodes to mesh the outlet.</span>
<span class="sd">    - snodes_inlet (int): the number of nodes to mesh the inlet top and bottom sides.</span>
<span class="sd">    - snodes_outlet (int): the number of nodes to mesh the outlet top and bottom sides.</span>
<span class="sd">    - c_snodes (int): the number of nodes to mesh the inner sides.</span>
<span class="sd">    - le (int): the number of nodes to mesh the blade leading edge portion.</span>
<span class="sd">    - te (int): the number of nodes to mesh the blade trailing edge lower portion.</span>
<span class="sd">    - nodes_sp2 (int): the number of nodes to mesh the 1st section of the blade suction side.</span>
<span class="sd">    - nodes_sp3 (int): the number of nodes to mesh the 2nd section of the blade suction side.</span>
<span class="sd">    - nodes_sp4 (int): the number of nodes to mesh the 3rd section of the blade suction side.</span>
<span class="sd">    - nodes_sp7 (int): the number of nodes to mesh the 1st section of the blade pressure side.</span>
<span class="sd">    - nodes_sp8 (int): the number of nodes to mesh the 2nd section of the blade pressure side.</span>
<span class="sd">    - nodes_ss (int): the number of nodes to mesh the suction side (dlr_mesh set to False).</span>
<span class="sd">    - nodes_ps (int): the number of nodes to mesh the pressure side (dlr_mesh set to False).</span>
<span class="sd">    - cyl_vin (float): cylinder field parameter Vin.</span>
<span class="sd">    - cyl_vout (float): cylinder field parameter Vout.</span>
<span class="sd">    - cyl_xaxis (float): cylinder field parameter Xaxis.</span>
<span class="sd">    - cyl_xcenter (float): cylinder field parameter Xcenter.</span>

<span class="sd">    Note:</span>
<span class="sd">        for the DLR configuration, the blade is split into 9 splines (clockwise from the tip):</span>

<span class="sd">        * 2 splines (1 and 9) for the leading edge parameterized with **le**</span>
<span class="sd">          i.e. each spline has **le**/2 nodes,</span>
<span class="sd">        * 2 splines (5 and 6) for the trailing edge parameterized with **te**</span>
<span class="sd">          i.e. each spline has **te**/2 nodes,</span>
<span class="sd">        * 3 splines for the suction side (2, 3, 4) of lengths 0.027, 0.038 and 0.061 m,</span>
<span class="sd">          and parameterized with **nodes_sp2**, **nodes_sp3** and **nodes_sp4**,</span>
<span class="sd">        * 2 splines for the pressure side (7, 8) of lengths 0.0526 and 0.0167 m,</span>
<span class="sd">          and parameterized with **nodes_sp7**, **nodes_sp8**</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">datfile</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">doutlet</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;domain&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;outlet&quot;</span><span class="p">,</span> <span class="mf">6.3e-2</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dlr_mesh</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;DLR_mesh&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bl_sizefar</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;bl_sizefar&quot;</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nodes_inlet</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodes_inlet&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nodes_outlet</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodes_outlet&quot;</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">snodes_inlet</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;side_nodes_inlet&quot;</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">snodes_outlet</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;side_nodes_outlet&quot;</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">c_snodes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;curved_side_nodes&quot;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">le</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;le&quot;</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">te</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;te&quot;</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sp2</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodes_sp2&quot;</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sp3</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodes_sp3&quot;</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sp4</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodes_sp4&quot;</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sp7</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodes_sp7&quot;</span><span class="p">,</span> <span class="mi">57</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sp8</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodes_sp8&quot;</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nodes_ss</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodes_ss&quot;</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nodes_ps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodes_ps&quot;</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cyl_vin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cyl_vin&quot;</span><span class="p">,</span> <span class="mf">8e-4</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cyl_vout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cyl_vout&quot;</span><span class="p">,</span> <span class="mf">5e-3</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cyl_xaxis</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cyl_xaxis&quot;</span><span class="p">,</span> <span class="mf">1.675e-2</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cyl_xcenter</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gmsh&quot;</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cyl_xcenter&quot;</span><span class="p">,</span> <span class="mf">8.364e-2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesh.cascade_mesh.CascadeMesh.build_2dmesh" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_2dmesh</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p><strong>Builds</strong> the surface mesh of the computational domain.</p>


            <details class="quote">
              <summary>Source code in <code>aero_optim/mesh/cascade_mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build_2dmesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Builds** the surface mesh of the computational domain.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">wall</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reorder_blade</span><span class="p">()</span>
    <span class="n">pt_wall</span> <span class="o">=</span> <span class="p">[</span><span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">wall</span><span class="p">]</span>

    <span class="c1"># blade splines and transfinite curves</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlr_mesh</span><span class="p">:</span>
        <span class="n">spl_1</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_wall</span><span class="p">[:</span><span class="mi">35</span><span class="p">])</span>
        <span class="n">spl_2</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">35</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">88</span><span class="p">])</span>
        <span class="n">spl_3</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">88</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">129</span><span class="p">])</span>
        <span class="n">spl_4</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">129</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">157</span><span class="p">])</span>
        <span class="n">spl_5</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">157</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">168</span><span class="p">])</span>
        <span class="n">spl_6</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">168</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">179</span><span class="p">])</span>
        <span class="n">spl_7</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">179</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">245</span><span class="p">])</span>
        <span class="n">spl_8</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">245</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">287</span><span class="p">])</span>
        <span class="n">spl_9</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">287</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">322</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">le</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.02</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sp2</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.03</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sp3</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sp4</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">0.94</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">te</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">0.97</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_6</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">te</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.025</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_7</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sp7</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.015</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_8</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sp8</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">0.955</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_9</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">le</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">)</span>
        <span class="n">spl_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">spl_1</span><span class="p">,</span> <span class="n">spl_2</span><span class="p">,</span> <span class="n">spl_3</span><span class="p">,</span> <span class="n">spl_4</span><span class="p">,</span> <span class="n">spl_5</span><span class="p">,</span> <span class="n">spl_6</span><span class="p">,</span> <span class="n">spl_7</span><span class="p">,</span> <span class="n">spl_8</span><span class="p">,</span> <span class="n">spl_9</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">spl_le</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">287</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">322</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">pt_wall</span><span class="p">[:</span><span class="mi">35</span><span class="p">])</span>
        <span class="n">spl_ss</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span>
            <span class="n">pt_wall</span><span class="p">[</span><span class="mi">35</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">88</span><span class="p">]</span> <span class="o">+</span> <span class="n">pt_wall</span><span class="p">[</span><span class="mi">88</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">129</span><span class="p">]</span> <span class="o">+</span> <span class="n">pt_wall</span><span class="p">[</span><span class="mi">129</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">157</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">spl_te</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">157</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">168</span><span class="p">]</span> <span class="o">+</span> <span class="n">pt_wall</span><span class="p">[</span><span class="mi">168</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">179</span><span class="p">])</span>
        <span class="n">spl_ps</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addSpline</span><span class="p">(</span><span class="n">pt_wall</span><span class="p">[</span><span class="mi">179</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">245</span><span class="p">]</span> <span class="o">+</span> <span class="n">pt_wall</span><span class="p">[</span><span class="mi">245</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="mi">287</span><span class="p">])</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_le</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">le</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_ss</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_ss</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_te</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">te</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">spl_ps</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_ps</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">spl_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">spl_le</span><span class="p">,</span> <span class="n">spl_ss</span><span class="p">,</span> <span class="n">spl_te</span><span class="p">,</span> <span class="n">spl_ps</span><span class="p">]</span>
    <span class="n">blade_loop</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">(</span><span class="n">spl_list</span><span class="p">)</span>

    <span class="c1"># domain construction points</span>
    <span class="n">pt_323</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="o">-</span><span class="mf">6e-2</span><span class="p">,</span> <span class="o">-</span><span class="mf">5e-2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">pt_324</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5e-2</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5e-2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">pt_325</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.7e-2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">pt_326</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">1.270973e-02</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.164466e-02</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">pt_327</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">2.585445e-02</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.360298e-03</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">pt_328</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">3.934429e-02</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.053609e-03</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">pt_329</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">5.308943e-02</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.631280e-03</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">pt_330</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">6.7e-2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">pt_331</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">6.7e-2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">doutlet</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">pt_332</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">6.7e-2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">doutlet</span><span class="p">,</span> <span class="mf">4.039e-2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">pt_333</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">6.7e-2</span><span class="p">,</span> <span class="mf">4.039e-2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">pt_334</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">5.308943e-02</span><span class="p">,</span> <span class="mf">3.875872e-02</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">pt_335</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">3.934429e-02</span><span class="p">,</span> <span class="mf">3.633639e-02</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">pt_336</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">2.585445e-02</span><span class="p">,</span> <span class="mf">3.302970e-02</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">pt_337</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">1.270973e-02</span><span class="p">,</span> <span class="mf">2.874534e-02</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">pt_338</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">2.339e-2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">pt_339</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5e-2</span><span class="p">,</span> <span class="mf">1.539e-2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">pt_340</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="o">-</span><span class="mf">6e-2</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.61e-3</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>

    <span class="c1"># domain construction lines</span>
    <span class="n">l_10</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_340</span><span class="p">,</span> <span class="n">pt_323</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">l_11</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_323</span><span class="p">,</span> <span class="n">pt_324</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">l_12</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_339</span><span class="p">,</span> <span class="n">pt_340</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlr_mesh</span><span class="p">:</span>
        <span class="n">l_13</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_324</span><span class="p">,</span> <span class="n">pt_339</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">l_14</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_324</span><span class="p">,</span> <span class="n">pt_325</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">l_15</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_325</span><span class="p">,</span> <span class="n">pt_326</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">l_16</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_326</span><span class="p">,</span> <span class="n">pt_327</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">l_17</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_327</span><span class="p">,</span> <span class="n">pt_328</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">l_18</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_328</span><span class="p">,</span> <span class="n">pt_329</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">l_19</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_329</span><span class="p">,</span> <span class="n">pt_330</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span>
    <span class="n">l_20</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_330</span><span class="p">,</span> <span class="n">pt_331</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">l_21</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_331</span><span class="p">,</span> <span class="n">pt_332</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
    <span class="n">l_22</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_332</span><span class="p">,</span> <span class="n">pt_333</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">l_23</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_333</span><span class="p">,</span> <span class="n">pt_334</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
    <span class="n">l_24</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_334</span><span class="p">,</span> <span class="n">pt_335</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
    <span class="n">l_25</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_335</span><span class="p">,</span> <span class="n">pt_336</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
    <span class="n">l_26</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_336</span><span class="p">,</span> <span class="n">pt_337</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
    <span class="n">l_27</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_337</span><span class="p">,</span> <span class="n">pt_338</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span>
    <span class="n">l_28</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">pt_338</span><span class="p">,</span> <span class="n">pt_339</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>

    <span class="c1"># transfinite curves on non-blade boundaries</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">l_10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_inlet</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlr_mesh</span><span class="p">:</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">l_13</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_inlet</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">l_21</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_outlet</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
    <span class="c1"># bottom / top periodicity</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span> <span class="o">=</span> <span class="p">[</span><span class="n">l_11</span><span class="p">,</span> <span class="n">l_14</span><span class="p">,</span> <span class="n">l_15</span><span class="p">,</span> <span class="n">l_16</span><span class="p">,</span> <span class="n">l_17</span><span class="p">,</span> <span class="n">l_18</span><span class="p">,</span> <span class="n">l_19</span><span class="p">,</span> <span class="n">l_20</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span> <span class="o">=</span> <span class="p">[</span><span class="n">l_12</span><span class="p">,</span> <span class="n">l_28</span><span class="p">,</span> <span class="n">l_27</span><span class="p">,</span> <span class="n">l_26</span><span class="p">,</span> <span class="n">l_25</span><span class="p">,</span> <span class="n">l_24</span><span class="p">,</span> <span class="n">l_23</span><span class="p">,</span> <span class="n">l_22</span><span class="p">]</span>
    <span class="c1"># bottom non-curved side nodes</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">l_11</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">snodes_inlet</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">l_20</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">snodes_outlet</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
    <span class="c1"># bottom curved side nodes</span>
    <span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteCurve</span><span class="p">(</span><span class="n">l_i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_snodes</span><span class="p">,</span> <span class="s2">&quot;Progression&quot;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
         <span class="k">for</span> <span class="n">l_i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="c1"># periodic boundaries /y direction</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
    <span class="n">translation</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.04039</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">tid</span><span class="p">,</span> <span class="n">bid</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span><span class="p">):</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setPeriodic</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">tid</span><span class="p">],</span> <span class="p">[</span><span class="n">bid</span><span class="p">],</span> <span class="n">translation</span><span class="p">)</span>

    <span class="c1"># closed curve loop and computational domain surface definition</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlr_mesh</span><span class="p">:</span>
        <span class="n">cloop_2</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">([</span><span class="n">l_10</span><span class="p">,</span> <span class="n">l_11</span><span class="p">,</span> <span class="n">l_12</span><span class="p">,</span> <span class="n">l_13</span><span class="p">])</span>
        <span class="n">cloop_3</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">(</span>
            <span class="p">[</span><span class="o">-</span><span class="n">l_13</span><span class="p">,</span> <span class="n">l_14</span><span class="p">,</span> <span class="n">l_15</span><span class="p">,</span> <span class="n">l_16</span><span class="p">,</span> <span class="n">l_17</span><span class="p">,</span> <span class="n">l_18</span><span class="p">,</span> <span class="n">l_19</span><span class="p">,</span> <span class="n">l_20</span><span class="p">,</span>
             <span class="n">l_21</span><span class="p">,</span> <span class="n">l_22</span><span class="p">,</span> <span class="n">l_23</span><span class="p">,</span> <span class="n">l_24</span><span class="p">,</span> <span class="n">l_25</span><span class="p">,</span> <span class="n">l_26</span><span class="p">,</span> <span class="n">l_27</span><span class="p">,</span> <span class="n">l_28</span><span class="p">,]</span>
        <span class="p">)</span>
        <span class="n">surf_1</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPlaneSurface</span><span class="p">([</span><span class="n">cloop_2</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1002</span><span class="p">)</span>
        <span class="n">surf_2</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPlaneSurface</span><span class="p">([</span><span class="n">cloop_3</span><span class="p">,</span> <span class="n">blade_loop</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1003</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setTransfiniteSurface</span><span class="p">(</span><span class="n">surf_1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cloop_3</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">(</span>
            <span class="p">[</span><span class="n">l_10</span><span class="p">,</span> <span class="n">l_11</span><span class="p">,</span> <span class="n">l_14</span><span class="p">,</span> <span class="n">l_15</span><span class="p">,</span> <span class="n">l_16</span><span class="p">,</span> <span class="n">l_17</span><span class="p">,</span> <span class="n">l_18</span><span class="p">,</span> <span class="n">l_19</span><span class="p">,</span> <span class="n">l_20</span><span class="p">,</span>
             <span class="n">l_21</span><span class="p">,</span> <span class="n">l_22</span><span class="p">,</span> <span class="n">l_23</span><span class="p">,</span> <span class="n">l_24</span><span class="p">,</span> <span class="n">l_25</span><span class="p">,</span> <span class="n">l_26</span><span class="p">,</span> <span class="n">l_27</span><span class="p">,</span> <span class="n">l_28</span><span class="p">,</span> <span class="n">l_12</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">surf_2</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPlaneSurface</span><span class="p">([</span><span class="n">cloop_3</span><span class="p">,</span> <span class="n">blade_loop</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1003</span><span class="p">)</span>

    <span class="c1"># Fields definition</span>
    <span class="c1"># Boundary Layer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">build_bl</span><span class="p">(</span><span class="n">spl_list</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="c1"># Cylinder #1</span>
    <span class="n">f_cyl1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_cylinder_field</span><span class="p">(</span>
        <span class="mf">9e-3</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cyl_vin</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cyl_vout</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cyl_xaxis</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cyl_xcenter</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.171e-3</span><span class="p">,</span>
        <span class="mf">1.9754e-2</span>
    <span class="p">)</span>
    <span class="c1"># Cylinder #2</span>
    <span class="n">f_cyl2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_cylinder_field</span><span class="p">(</span>
        <span class="mf">1.62e-2</span><span class="p">,</span> <span class="mf">1.6e-3</span><span class="p">,</span> <span class="mf">5e-3</span><span class="p">,</span> <span class="mf">2.01e-2</span><span class="p">,</span> <span class="mf">8.699e-2</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.406e-3</span><span class="p">,</span> <span class="mf">1.9519e-2</span>
    <span class="p">)</span>
    <span class="c1"># MinAniso</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">build_minaniso_field</span><span class="p">([</span><span class="n">f_cyl1</span><span class="p">,</span> <span class="n">f_cyl2</span><span class="p">])</span>

    <span class="c1"># define physical groups for boundary conditions</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">surf_tag</span> <span class="o">=</span> <span class="p">[</span><span class="n">surf_1</span><span class="p">,</span> <span class="n">surf_2</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlr_mesh</span> <span class="k">else</span> <span class="p">[</span><span class="n">surf_2</span><span class="p">]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extrusion_layers</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">surf_tag</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;fluid&quot;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">l_10</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;inlet&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2D BC: Inlet tags are </span><span class="si">{</span><span class="p">[</span><span class="n">l_10</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">l_21</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;outlet&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2D BC: Outlet tags are </span><span class="si">{</span><span class="p">[</span><span class="n">l_21</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">spl_list</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;wall&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2D BC: Wall tags are </span><span class="si">{</span><span class="n">spl_list</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;periodic_vert_l&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2D BC: Top tags are </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;periodic_vert_r&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2D BC: Bottom tags are </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">surf_tag</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;periodic_span_l&quot;</span><span class="p">)</span>

    <span class="c1"># non-corner points defined as flow-field, inner block line and wall nodes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">non_corner_tags</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">s_tag</span><span class="p">)</span> <span class="k">for</span> <span class="n">s_tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">surf_tag</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">non_corner_tags</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">s_tag</span><span class="p">)</span> <span class="k">for</span> <span class="n">s_tag</span> <span class="ow">in</span> <span class="n">spl_list</span><span class="p">])</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlr_mesh</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">non_corner_tags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">l_13</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesh.cascade_mesh.CascadeMesh.build_3dmesh" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_3dmesh</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p><strong>Performs</strong> an extrusion along the z axis.
- h_size (float): the total extruded depth.</p>


            <details class="quote">
              <summary>Source code in <code>aero_optim/mesh/cascade_mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build_3dmesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Performs** an extrusion along the z axis.</span>
<span class="sd">    - h_size (float): the total extruded depth.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extrusion_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ext_tag</span> <span class="o">=</span> <span class="p">[</span><span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">extrude</span><span class="p">(</span>
        <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">)],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">h_size</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">extrusion_layers</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">surf_tag</span><span class="p">]</span>
    <span class="c1"># retrieve extruded surfaces and volumes</span>
    <span class="n">vol</span> <span class="o">=</span> <span class="p">[</span><span class="n">tu</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">tu</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ext_tag</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext_tag</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]]]</span>
    <span class="n">top</span> <span class="o">=</span> <span class="p">[</span><span class="n">tu</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">tu</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ext_tag</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext_tag</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]]]</span>
    <span class="c1"># 1st block</span>
    <span class="n">inlet</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ext_tag</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">perlo</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ext_tag</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">perup</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ext_tag</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="c1"># 2nd block</span>
    <span class="n">perlo</span> <span class="o">+=</span> <span class="p">[</span><span class="n">tu</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">tu</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext_tag</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">:</span><span class="mi">10</span><span class="p">]]</span>
    <span class="n">outlet</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ext_tag</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">10</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">perup</span> <span class="o">+=</span> <span class="p">[</span><span class="n">tu</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">tu</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext_tag</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">11</span><span class="p">:</span><span class="mi">18</span><span class="p">]]</span>
    <span class="n">wall</span> <span class="o">=</span> <span class="p">[</span><span class="n">tu</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">tu</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext_tag</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">18</span><span class="p">:]]</span>
    <span class="c1"># create physical groups</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">vol</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;fluid&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;3D BC: vol tag is 2000&quot;</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">2001</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;periodic_span_r&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;3D BC: periodic_span_l tag is 100&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;3D BC: periodic_span_r tag is 2001&quot;</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">perlo</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">2003</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;periodic_vert_l&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;3D BC: periodic_vert_l tag is 2003&quot;</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">perup</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">2004</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;periodic_vert_r&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;3D BC: periodic_vert_r tag is 2004&quot;</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">inlet</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">2005</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;inlet&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;3D BC: inlet tag is 2005&quot;</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">outlet</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">2006</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;outlet&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;3D BC: outlet tag is 2006&quot;</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">wall</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">2007</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;wall&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;3D BC: wall tag is 2007&quot;</span><span class="p">)</span>
    <span class="c1"># set 2 tags to none to prevent reformatting</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">non_corner_tags</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bottom_tags</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">top_tags</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesh.cascade_mesh.CascadeMesh.build_bl" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_bl</span><span class="p">(</span><span class="n">blade_tag</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span></code>

</h4>


    <div class="doc doc-contents ">

        <p><strong>Builds</strong> the boundary layer around the blade.</p>


            <details class="quote">
              <summary>Source code in <code>aero_optim/mesh/cascade_mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build_bl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">blade_tag</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Builds** the boundary layer around the blade.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">f_bl</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;BoundaryLayer&#39;</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumbers</span><span class="p">(</span><span class="n">f_bl</span><span class="p">,</span> <span class="s1">&#39;CurvesList&#39;</span><span class="p">,</span> <span class="n">blade_tag</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_bl</span><span class="p">,</span> <span class="s1">&#39;Size&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl_size</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_bl</span><span class="p">,</span> <span class="s1">&#39;Ratio&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl_ratio</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_bl</span><span class="p">,</span> <span class="s1">&#39;Quads&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structured</span><span class="p">))</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_bl</span><span class="p">,</span> <span class="s1">&#39;Thickness&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl_thickness</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_bl</span><span class="p">,</span> <span class="s1">&#39;SizeFar&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bl_sizefar</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setAsBoundaryLayer</span><span class="p">(</span><span class="n">f_bl</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesh.cascade_mesh.CascadeMesh.build_cylinder_field" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_cylinder_field</span><span class="p">(</span><span class="n">radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">VIn</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">VOut</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">XAxis</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">XCenter</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">YAxis</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">YCenter</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ZAxis</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span></code>

</h4>


    <div class="doc doc-contents ">

        <p><strong>Builds</strong> a cylinder field in the computational domain.</p>


            <details class="quote">
              <summary>Source code in <code>aero_optim/mesh/cascade_mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build_cylinder_field</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">VIn</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">VOut</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">XAxis</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">XCenter</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">YAxis</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">YCenter</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">ZAxis</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Builds** a cylinder field in the computational domain.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">f_cyl</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;Cylinder&#39;</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_cyl</span><span class="p">,</span> <span class="s1">&#39;Radius&#39;</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_cyl</span><span class="p">,</span> <span class="s1">&#39;VIn&#39;</span><span class="p">,</span> <span class="n">VIn</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_cyl</span><span class="p">,</span> <span class="s1">&#39;VOut&#39;</span><span class="p">,</span> <span class="n">VOut</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_cyl</span><span class="p">,</span> <span class="s1">&#39;XAxis&#39;</span><span class="p">,</span> <span class="n">XAxis</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_cyl</span><span class="p">,</span> <span class="s1">&#39;XCenter&#39;</span><span class="p">,</span> <span class="n">XCenter</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_cyl</span><span class="p">,</span> <span class="s1">&#39;YAxis&#39;</span><span class="p">,</span> <span class="n">YAxis</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_cyl</span><span class="p">,</span> <span class="s1">&#39;YCenter&#39;</span><span class="p">,</span> <span class="n">YCenter</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">f_cyl</span><span class="p">,</span> <span class="s1">&#39;ZAxis&#39;</span><span class="p">,</span> <span class="n">ZAxis</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setAsBackgroundMesh</span><span class="p">(</span><span class="n">f_cyl</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">f_cyl</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesh.cascade_mesh.CascadeMesh.build_minaniso_field" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_minaniso_field</span><span class="p">(</span><span class="n">tag</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span></code>

</h4>


    <div class="doc doc-contents ">

        <p><strong>Builds</strong> a MinAniso field in the computational domain.</p>


            <details class="quote">
              <summary>Source code in <code>aero_optim/mesh/cascade_mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build_minaniso_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Builds** a MinAniso field in the computational domain.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">f_minaniso</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;MinAniso&#39;</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumbers</span><span class="p">(</span><span class="n">f_minaniso</span><span class="p">,</span> <span class="s1">&#39;FieldsList&#39;</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setAsBackgroundMesh</span><span class="p">(</span><span class="n">f_minaniso</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mesh.cascade_mesh.CascadeMesh.reorder_blade" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reorder_blade</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span></code>

</h4>


    <div class="doc doc-contents ">

        <p><strong>Returns</strong> the blade profile after reordering.</p>


            <details class="quote">
              <summary>Source code in <code>aero_optim/mesh/cascade_mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reorder_blade</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Returns** the blade profile after reordering.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">([</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">])</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="n">start</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="n">start</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[:</span><span class="n">start</span><span class="p">]]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[:</span><span class="n">start</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts</span><span class="p">[</span><span class="n">start</span><span class="p">:]]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../dev_ffd/" class="btn btn-neutral float-left" title="FFD Module"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../dev_simulator/" class="btn btn-neutral float-right" title="Simulator Module">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/mschouler/aero-optim" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../dev_ffd/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../dev_simulator/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
